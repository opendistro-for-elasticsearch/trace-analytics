{"version":3,"file":"1.plugin.js","sources":["/plugin:opendistro-trace-analytics-kibana/packages/elastic-datemath/target/index.js","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/application.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/app.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/color_palette.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/filters/filter_edit_popover.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/filters/filter_helpers.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/filters/filters.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/helper_functions.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/index.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/box_plt.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/error_rate_plt.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/latency_trend_plt.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/plt.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/service_map.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/service_map_scale.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/plots/throughput_plt.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/search_bar.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/common/side_nav.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/dashboard/dashboard.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/dashboard/dashboard_table.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/dashboard/index.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/dashboard/latency_trend_cell.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/services/index.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/services/service_view.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/services/services.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/services/services_table.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/index.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/service_breakdown_panel.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/span_detail_panel.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/trace_view.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/traces.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/components/traces/traces_table.tsx","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/dashboard_request_handler.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/queries/dashboard_queries.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/queries/services_queries.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/queries/traces_queries.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/request_handler.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/services_request_handler.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/public/requests/traces_request_handler.ts","/plugin:opendistro-trace-analytics-kibana/plugins/trace-analytics/server/utils/constants.ts"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nvar unitsMap = {\n  ms: {\n    weight: 1,\n    type: 'fixed',\n    base: 1\n  },\n  s: {\n    weight: 2,\n    type: 'fixed',\n    base: 1000\n  },\n  m: {\n    weight: 3,\n    type: 'mixed',\n    base: 1000 * 60\n  },\n  h: {\n    weight: 4,\n    type: 'mixed',\n    base: 1000 * 60 * 60\n  },\n  d: {\n    weight: 5,\n    type: 'mixed',\n    base: 1000 * 60 * 60 * 24\n  },\n  w: {\n    weight: 6,\n    type: 'calendar',\n    base: NaN\n  },\n  M: {\n    weight: 7,\n    type: 'calendar',\n    base: NaN\n  },\n  // q: { weight: 8, type: 'calendar' }, // TODO: moment duration does not support quarter\n  y: {\n    weight: 9,\n    type: 'calendar',\n    base: NaN\n  }\n};\nvar units = Object.keys(unitsMap).sort(function (a, b) {\n  return unitsMap[b].weight - unitsMap[a].weight;\n});\n\nvar unitsDesc = _toConsumableArray(units);\n\nvar unitsAsc = _toConsumableArray(units).reverse();\n\nvar isDate = function isDate(d) {\n  return Object.prototype.toString.call(d) === '[object Date]';\n};\n\nvar isValidDate = function isValidDate(d) {\n  return isDate(d) && !isNaN(d.valueOf());\n};\n/*\n * This is a simplified version of elasticsearch's date parser.\n * If you pass in a momentjs instance as the third parameter the calculation\n * will be done using this (and its locale settings) instead of the one bundled\n * with this library.\n */\n\n\nfunction parse(text) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref$roundUp = _ref.roundUp,\n      roundUp = _ref$roundUp === void 0 ? false : _ref$roundUp,\n      _ref$momentInstance = _ref.momentInstance,\n      momentInstance = _ref$momentInstance === void 0 ? _moment.default : _ref$momentInstance,\n      forceNow = _ref.forceNow;\n\n  if (!text) return undefined;\n  if (momentInstance.isMoment(text)) return text;\n  if (isDate(text)) return momentInstance(text);\n\n  if (forceNow !== undefined && !isValidDate(forceNow)) {\n    throw new Error('forceNow must be a valid Date');\n  }\n\n  var time;\n  var mathString = '';\n  var index;\n  var parseString;\n\n  if (text.substring(0, 3) === 'now') {\n    time = momentInstance(forceNow);\n    mathString = text.substring('now'.length);\n  } else {\n    index = text.indexOf('||');\n\n    if (index === -1) {\n      parseString = text;\n      mathString = ''; // nothing else\n    } else {\n      parseString = text.substring(0, index);\n      mathString = text.substring(index + 2);\n    } // We're going to just require ISO8601 timestamps, k?\n\n\n    time = momentInstance(parseString);\n  }\n\n  if (!mathString.length) {\n    return time;\n  }\n\n  return parseDateMath(mathString, time, roundUp);\n}\n\nfunction parseDateMath(mathString, time, roundUp) {\n  var dateTime = time;\n  var len = mathString.length;\n  var i = 0;\n\n  while (i < len) {\n    var c = mathString.charAt(i++);\n    var type = void 0;\n    var num = void 0;\n    var unit = void 0;\n\n    if (c === '/') {\n      type = 0;\n    } else if (c === '+') {\n      type = 1;\n    } else if (c === '-') {\n      type = 2;\n    } else {\n      return;\n    }\n\n    if (isNaN(mathString.charAt(i))) {\n      num = 1;\n    } else if (mathString.length === 2) {\n      num = mathString.charAt(i);\n    } else {\n      var numFrom = i;\n\n      while (!isNaN(mathString.charAt(i))) {\n        i++;\n        if (i >= len) return;\n      }\n\n      num = parseInt(mathString.substring(numFrom, i), 10);\n    }\n\n    if (type === 0) {\n      // rounding is only allowed on whole, single, units (eg M or 1M, not 0.5M or 2M)\n      if (num !== 1) {\n        return;\n      }\n    }\n\n    unit = mathString.charAt(i++); // append additional characters in the unit\n\n    for (var j = i; j < len; j++) {\n      var unitChar = mathString.charAt(i);\n\n      if (/[a-z]/i.test(unitChar)) {\n        unit += unitChar;\n        i++;\n      } else {\n        break;\n      }\n    }\n\n    if (units.indexOf(unit) === -1) {\n      return;\n    } else {\n      if (type === 0) {\n        if (roundUp) dateTime.endOf(unit);else dateTime.startOf(unit);\n      } else if (type === 1) {\n        dateTime.add(num, unit);\n      } else if (type === 2) {\n        dateTime.subtract(num, unit);\n      }\n    }\n  }\n\n  return dateTime;\n}\n\nvar _default = {\n  parse: parse,\n  unitsMap: Object.freeze(unitsMap),\n  units: Object.freeze(units),\n  unitsAsc: Object.freeze(unitsAsc),\n  unitsDesc: Object.freeze(unitsDesc)\n};\nexports.default = _default;\nmodule.exports = exports.default;","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { TraceAnalyticsApp } from './components/app';\nexport const renderApp = ({\n  notifications,\n  http,\n  uiSettings,\n  chrome\n}, {\n  navigation\n}, {\n  appBasePath,\n  element\n}) => {\n  ReactDOM.render( /*#__PURE__*/React.createElement(TraceAnalyticsApp, {\n    basename: appBasePath,\n    notifications: notifications,\n    http: http,\n    uiSettings: uiSettings,\n    chrome: chrome,\n    navigation: navigation\n  }), element);\n  return () => ReactDOM.unmountComponentAtNode(element);\n};","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\n/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { I18nProvider } from '@kbn/i18n/react';\nimport React, { useEffect, useState } from 'react';\nimport { HashRouter, Route, Switch } from 'react-router-dom';\nimport { handleIndicesExistRequest } from '../requests/request_handler';\nimport { renderPageWithSidebar } from './common/side_nav';\nimport { Dashboard } from './dashboard';\nimport { Services, ServiceView } from './services';\nimport { Traces, TraceView } from './traces';\nexport const TraceAnalyticsApp = ({\n  basename,\n  notifications,\n  http,\n  uiSettings,\n  chrome,\n  navigation\n}) => {\n  const [indicesExist, setIndicesExist] = useState(true);\n  const storedFilters = localStorage.getItem('TraceAnalyticsFilters');\n  const [query, setQuery] = useState(localStorage.getItem('TraceAnalyticsQuery') || '');\n  const [filters, setFilters] = useState(storedFilters ? JSON.parse(storedFilters) : []);\n  const [startTime, setStartTime] = useState(localStorage.getItem('TraceAnalyticsStartTime') || 'now-5m');\n  const [endTime, setEndTime] = useState(localStorage.getItem('TraceAnalyticsEndTime') || 'now');\n\n  const setFiltersWithStorage = newFilters => {\n    setFilters(newFilters);\n    localStorage.setItem('TraceAnalyticsFilters', JSON.stringify(newFilters));\n  };\n\n  const setQueryWithStorage = newQuery => {\n    setQuery(newQuery);\n    localStorage.setItem('TraceAnalyticsQuery', newQuery);\n  };\n\n  const setStartTimeWithStorage = newStartTime => {\n    setStartTime(newStartTime);\n    localStorage.setItem('TraceAnalyticsStartTime', newStartTime);\n  };\n\n  const setEndTimeWithStorage = newEndTime => {\n    setEndTime(newEndTime);\n    localStorage.setItem('TraceAnalyticsEndTime', newEndTime);\n  };\n\n  useEffect(() => {\n    handleIndicesExistRequest(http, setIndicesExist);\n  }, []);\n  const commonProps = {\n    http,\n    uiSettings,\n    setBreadcrumbs: chrome.setBreadcrumbs,\n    query,\n    setQuery: setQueryWithStorage,\n    filters,\n    setFilters: setFiltersWithStorage,\n    startTime,\n    setStartTime: setStartTimeWithStorage,\n    endTime,\n    setEndTime: setEndTimeWithStorage,\n    indicesExist\n  };\n  return /*#__PURE__*/React.createElement(HashRouter, null, /*#__PURE__*/React.createElement(I18nProvider, null, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Switch, null, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: ['/dashboard', '/'],\n    render: props => renderPageWithSidebar( /*#__PURE__*/React.createElement(Dashboard, commonProps), 1)\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/traces\",\n    render: props => renderPageWithSidebar( /*#__PURE__*/React.createElement(Traces, commonProps), 2)\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/traces/:id+\",\n    render: props => /*#__PURE__*/React.createElement(TraceView, {\n      setBreadcrumbs: chrome.setBreadcrumbs,\n      http: http,\n      uiSettings: uiSettings,\n      traceId: decodeURIComponent(props.match.params.id)\n    })\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/services\",\n    render: props => renderPageWithSidebar( /*#__PURE__*/React.createElement(Services, commonProps), 3)\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/services/:id+\",\n    render: props => /*#__PURE__*/React.createElement(ServiceView, _extends({\n      serviceName: decodeURIComponent(props.match.params.id)\n    }, commonProps, {\n      addFilter: filter => {\n        for (const addedFilter of filters) {\n          if (addedFilter.field === filter.field && addedFilter.operator === filter.operator && addedFilter.value === filter.value) {\n            return;\n          }\n        }\n\n        const newFilters = [...filters, filter];\n        setFiltersWithStorage(newFilters);\n      }\n    }))\n  })))));\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport const serviceMapColorPalette = {\n  latency: ['218, 214, 227', '216, 212, 226', '215, 209, 226', '213, 207, 225', '212, 205, 224', '210, 202, 224', '208, 200, 223', '207, 198, 222', '205, 195, 222', '203, 193, 221', '202, 191, 220', '200, 189, 219', '198, 186, 218', '197, 184, 217', '195, 182, 216', '193, 180, 216', '192, 177, 215', '190, 175, 214', '188, 173, 213', '187, 171, 212', '185, 169, 211', '183, 166, 210', '182, 164, 209', '180, 162, 207', '178, 160, 206', '177, 158, 205', '175, 155, 204', '173, 153, 203', '171, 151, 202', '170, 149, 201', '168, 147, 200', '166, 145, 198', '165, 143, 197', '163, 140, 196', '161, 138, 195', '160, 136, 193', '158, 134, 192', '156, 132, 191', '154, 130, 190', '153, 128, 188', '151, 126, 187', '149, 124, 186', '148, 122, 184', '146, 120, 183', '144, 118, 182', '142, 116, 180', '141, 114, 179', '139, 111, 177', '137, 109, 176', '136, 107, 175', '134, 105, 173', '132, 103, 172', '131, 101, 170', '129, 99, 169', '127, 97, 167', '125, 95, 166', '124, 93, 164', '122, 91, 163', '120, 90, 161', '119, 88, 160', '117, 86, 158', '115, 84, 157', '113, 82, 155', '112, 80, 154', '110, 78, 152', '108, 76, 151', '107, 74, 149', '105, 72, 148', '103, 70, 146', '102, 68, 144', '100, 66, 143', '98, 64, 141', '97, 63, 140', '95, 61, 138', '93, 59, 136', '91, 57, 135', '90, 55, 133', '88, 53, 132', '86, 51, 130', '85, 49, 128', '83, 47, 127', '81, 46, 125', '80, 44, 123', '78, 42, 122', '76, 40, 120', '75, 38, 119', '73, 36, 117', '71, 34, 115', '70, 32, 114', '68, 31, 112', '66, 29, 110', '65, 27, 108', '63, 25, 107', '61, 23, 105', '59, 21, 103', '58, 19, 102', '56, 17, 100', '54, 15, 98', '53, 12, 97', '51, 10, 95'],\n  error_rate: ['239, 224, 230', '239, 222, 228', '240, 219, 226', '240, 217, 224', '240, 214, 222', '240, 212, 221', '240, 209, 219', '240, 207, 217', '240, 204, 215', '240, 202, 213', '240, 200, 211', '240, 197, 209', '240, 195, 208', '239, 192, 206', '239, 190, 204', '239, 188, 202', '238, 185, 200', '238, 183, 198', '238, 181, 196', '237, 178, 195', '237, 176, 193', '236, 174, 191', '236, 172, 189', '235, 169, 187', '234, 167, 185', '234, 165, 184', '233, 163, 182', '232, 160, 180', '232, 158, 178', '231, 156, 176', '230, 154, 174', '229, 151, 173', '228, 149, 171', '227, 147, 169', '226, 145, 167', '225, 143, 165', '224, 141, 164', '223, 139, 162', '222, 136, 160', '221, 134, 158', '220, 132, 156', '219, 130, 155', '218, 128, 153', '217, 126, 151', '216, 124, 149', '214, 122, 147', '213, 120, 146', '212, 118, 144', '211, 116, 142', '209, 114, 140', '208, 112, 139', '207, 110, 137', '205, 108, 135', '204, 106, 133', '202, 104, 132', '201, 102, 130', '199, 100, 128', '198, 98, 126', '196, 96, 125', '195, 95, 123', '193, 93, 121', '192, 91, 119', '190, 89, 118', '189, 87, 116', '187, 85, 114', '186, 84, 113', '184, 82, 111', '182, 80, 109', '181, 78, 107', '179, 76, 106', '177, 75, 104', '175, 73, 102', '174, 71, 101', '172, 70, 99', '170, 68, 97', '168, 66, 96', '167, 65, 94', '165, 63, 92', '163, 61, 91', '161, 60, 89', '159, 58, 87', '157, 56, 86', '156, 55, 84', '154, 53, 83', '152, 52, 81', '150, 50, 79', '148, 49, 78', '146, 47, 76', '144, 46, 74', '142, 44, 73', '140, 43, 71', '138, 41, 70', '136, 40, 68', '134, 38, 66', '132, 37, 65', '130, 35, 63', '128, 34, 62', '126, 33, 60', '124, 31, 59', '122, 30, 57'],\n  throughput: ['216, 218, 225', '214, 216, 225', '211, 214, 226', '209, 212, 226', '206, 210, 226', '204, 208, 226', '202, 206, 226', '199, 204, 226', '197, 202, 226', '195, 199, 226', '193, 197, 226', '190, 195, 225', '188, 193, 225', '186, 191, 225', '184, 189, 224', '181, 187, 224', '179, 185, 223', '177, 183, 223', '175, 181, 222', '173, 179, 221', '171, 177, 221', '168, 175, 220', '166, 173, 219', '164, 171, 218', '162, 169, 218', '160, 167, 217', '158, 165, 216', '156, 164, 215', '154, 162, 214', '152, 160, 213', '150, 158, 212', '148, 156, 211', '146, 154, 210', '144, 152, 209', '142, 150, 208', '140, 148, 207', '138, 146, 206', '136, 144, 205', '134, 142, 204', '132, 140, 203', '130, 138, 202', '128, 137, 200', '126, 135, 199', '124, 133, 198', '122, 131, 197', '120, 129, 196', '118, 127, 194', '116, 125, 193', '114, 123, 192', '112, 122, 191', '110, 120, 189', '108, 118, 188', '106, 116, 187', '105, 114, 186', '103, 112, 184', '101, 110, 183', '99, 109, 182', '97, 107, 180', '95, 105, 179', '93, 103, 178', '91, 101, 176', '89, 100, 175', '88, 98, 173', '86, 96, 172', '84, 94, 171', '82, 92, 169', '80, 91, 168', '78, 89, 166', '76, 87, 165', '74, 85, 163', '72, 84, 162', '70, 82, 161', '68, 80, 159', '67, 78, 158', '65, 77, 156', '63, 75, 155', '61, 73, 153', '59, 72, 152', '57, 70, 150', '55, 68, 149', '53, 66, 147', '51, 65, 146', '49, 63, 144', '47, 61, 143', '45, 60, 141', '42, 58, 140', '40, 56, 138', '38, 55, 137', '36, 53, 135', '34, 51, 134', '31, 50, 132', '29, 48, 130', '26, 47, 129', '23, 45, 127', '20, 43, 126', '17, 42, 124', '14, 40, 123', '9, 39, 121', '5, 37, 120', '1, 36, 118']\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButton, EuiButtonEmpty, EuiComboBox, EuiFlexGroup, EuiFlexItem, EuiFormRow, EuiSpacer } from '@elastic/eui';\nimport React, { useState } from 'react';\nimport { getInvertedOperator, getOperatorOptions, getValueComponent } from './filter_helpers';\nexport function FilterEditPopover(props) {\n  var _props$filter, _selectedOperatorOpti, _selectedOperatorOpti2;\n\n  const [selectedFieldOptions, setSelectedFieldOptions] = useState(props.filter ? [{\n    label: props.filter.field\n  }] : []);\n  const [selectedOperatorOptions, setSelectedOperatorOptions] = useState(props.filter ? [{\n    label: getInvertedOperator(props.filter.operator, props.filter.inverted)\n  }] : []);\n  const [filterValue, setFilterValue] = useState(((_props$filter = props.filter) === null || _props$filter === void 0 ? void 0 : _props$filter.value) || '');\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: 400\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    style: {\n      width: 0,\n      height: 0,\n      position: 'fixed',\n      marginLeft: -1000,\n      bottom: 0\n    }\n  }), /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"s\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: 6\n  }, /*#__PURE__*/React.createElement(EuiFormRow, {\n    label: 'Field'\n  }, /*#__PURE__*/React.createElement(EuiComboBox, {\n    placeholder: \"Select a field first\",\n    isClearable: false,\n    options: props.filterFieldOptions,\n    selectedOptions: selectedFieldOptions,\n    onChange: e => {\n      setSelectedFieldOptions(e);\n      setSelectedOperatorOptions([]);\n      setFilterValue('');\n    },\n    singleSelection: {\n      asPlainText: true\n    }\n  }))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: 5\n  }, /*#__PURE__*/React.createElement(EuiFormRow, {\n    label: 'Operator'\n  }, /*#__PURE__*/React.createElement(EuiComboBox, {\n    placeholder: selectedFieldOptions.length === 0 ? 'Waiting' : 'Select',\n    isClearable: false,\n    isDisabled: selectedFieldOptions.length === 0,\n    options: selectedFieldOptions.length === 0 ? [] : getOperatorOptions(selectedFieldOptions[0].label),\n    selectedOptions: selectedOperatorOptions,\n    onChange: e => {\n      setSelectedOperatorOptions(e);\n      setFilterValue('');\n    },\n    singleSelection: {\n      asPlainText: true\n    }\n  })))), selectedOperatorOptions.length > 0 && getValueComponent(selectedOperatorOptions[0].label, filterValue, setFilterValue), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"s\",\n    justifyContent: \"flexEnd\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiButtonEmpty, {\n    onClick: props.closePopover\n  }, \"Cancel\")), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiButton, {\n    fill: true,\n    disabled: selectedFieldOptions.length === 0 || selectedOperatorOptions.length === 0 || filterValue.length === 0 && !((_selectedOperatorOpti = selectedOperatorOptions[0]) !== null && _selectedOperatorOpti !== void 0 && (_selectedOperatorOpti2 = _selectedOperatorOpti.label) !== null && _selectedOperatorOpti2 !== void 0 && _selectedOperatorOpti2.includes('exist')),\n    onClick: () => {\n      props.closePopover();\n      props.setFilter({\n        field: selectedFieldOptions[0].label,\n        operator: selectedOperatorOptions[0].label,\n        value: selectedOperatorOptions[0].label.includes('exist') ? 'exists' : filterValue,\n        inverted: selectedOperatorOptions[0].label.includes('not'),\n        disabled: props.filter ? props.filter.disabled : false\n      }, props.index);\n    }\n  }, \"Save\"))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFieldText, EuiFormControlLayoutDelimited, EuiFormRow, EuiSpacer } from '@elastic/eui';\nimport _ from 'lodash';\nimport React from 'react';\n\nconst getFields = page => ({\n  dashboard: ['traceGroup', 'status.code', 'status.message', 'durationInNanos'],\n  traces: ['traceId', 'traceGroup', 'status.code', 'status.message', 'durationInNanos'],\n  services: []\n})[page]; // filters will take effect and can be manually added\n\n\nexport const getFilterFields = page => getFields(page); // filters will take effect\n\nexport const getValidFilterFields = page => {\n  const fields = getFields(page);\n  if (page !== 'services') return [...fields, 'Latency percentile within trace group'];\n  return fields;\n};\nexport const getType = field => {\n  const typeMapping = {\n    attributes: {\n      host: {\n        port: 'long'\n      },\n      http: {\n        response_content_length: 'long',\n        status_code: 'long'\n      },\n      net: {\n        port: 'long'\n      }\n    },\n    attributes_host: {\n      port: 'long'\n    },\n    attributes_http: {\n      response_content_length: 'long',\n      status_code: 'long'\n    },\n    attributes_net: {\n      port: 'long'\n    },\n    durationInNanos: 'long',\n    endTime: 'date_nanos',\n    startTime: 'date_nanos'\n  };\n\n  const type = _.get(typeMapping, field, 'keyword');\n\n  return typeof type === 'string' ? type : null;\n};\nexport const getInvertedOperator = (operator, inverted) => {\n  if (operator.includes('between')) return inverted ? 'is not between' : 'is between';else if (operator.includes('exist')) return inverted ? 'does not exist' : 'exists';else if (operator === 'is' || operator === 'is not') return inverted ? 'is not' : 'is';\n};\nexport const getOperatorOptions = field => {\n  const type = getType(field);\n  const operatorMapping = {\n    long: [{\n      label: 'is between'\n    }, {\n      label: 'is not between'\n    }],\n    date_nanos: [{\n      label: 'is between'\n    }, {\n      label: 'is not between'\n    }],\n    keyword: [],\n    default_first: [{\n      label: 'is'\n    }, {\n      label: 'is not'\n    }],\n    default_last: [{\n      label: 'exists'\n    }, {\n      label: 'does not exist'\n    }]\n  };\n  const operators = [...operatorMapping.default_first, ...operatorMapping[type], ...operatorMapping.default_last];\n  return operators;\n};\nexport const getValueComponent = (operator, value, setValue) => {\n  const textField = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"s\"\n  }), /*#__PURE__*/React.createElement(EuiFormRow, {\n    label: 'Value'\n  }, /*#__PURE__*/React.createElement(EuiFieldText, {\n    placeholder: \"Enter a value\",\n    value: value,\n    onChange: e => setValue(e.target.value)\n  })));\n\n  const getRangeField = () => {\n    const getFromValue = () => {\n      if (value !== null && value !== void 0 && value.from) {\n        return value.from.includes('\\u221E') ? '' : value.from;\n      }\n\n      return '';\n    };\n\n    const getToValue = () => {\n      if (value !== null && value !== void 0 && value.to) {\n        return value.to.includes('\\u221E') ? '' : value.to;\n      }\n\n      return '';\n    };\n\n    const setFromValue = from => {\n      setValue({\n        from: from || '-\\u221E',\n        to: getToValue() || '\\u221E'\n      });\n    };\n\n    const setToValue = to => {\n      setValue({\n        from: getFromValue() || '-\\u221E',\n        to: to || '\\u221E'\n      });\n    };\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiSpacer, {\n      size: \"s\"\n    }), /*#__PURE__*/React.createElement(EuiFormRow, {\n      label: 'Value'\n    }, /*#__PURE__*/React.createElement(EuiFormControlLayoutDelimited, {\n      startControl: /*#__PURE__*/React.createElement(\"input\", {\n        type: \"string\",\n        placeholder: \"Start of range\",\n        className: \"euiFieldText\",\n        value: getFromValue(),\n        onChange: e => setFromValue(e.target.value)\n      }),\n      endControl: /*#__PURE__*/React.createElement(\"input\", {\n        type: \"string\",\n        placeholder: \"End of range\",\n        className: \"euiFieldText\",\n        value: getToValue(),\n        onChange: e => setToValue(e.target.value)\n      })\n    })));\n  };\n\n  const valueMapping = {\n    is: textField,\n    'is not': textField,\n    'is between': getRangeField(),\n    'is not between': getRangeField(),\n    exists: null,\n    'does not exist': null\n  };\n  return valueMapping[operator];\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiBadge, EuiButtonEmpty, EuiButtonIcon, EuiContextMenu, EuiFlexGroup, EuiFlexItem, EuiIcon, EuiPopover, EuiPopoverTitle, EuiTextColor } from '@elastic/eui';\nimport React, { useMemo, useState } from 'react';\nimport { FilterEditPopover } from './filter_edit_popover';\nimport { getFilterFields, getValidFilterFields } from './filter_helpers';\nexport function Filters(props) {\n  // set a filter at an index. if newFilter doesn't exist, remove filter at the index\n  // if index doesn't exist, append newFilter to the end\n  const setFilter = (newFilter, index) => {\n    const newFilters = [...props.filters];\n    if (newFilter) newFilters.splice(index, 1, newFilter);else newFilters.splice(index, 1);\n    props.setFilters(newFilters);\n  };\n\n  const validFilterFields = useMemo(() => getValidFilterFields(props.page), [props.page]);\n  const filterFieldOptions = useMemo(() => getFilterFields(props.page).map(field => ({\n    label: field\n  })), [props.page]);\n  const globalPopoverPanels = [{\n    id: 0,\n    title: 'Change all filters',\n    items: [{\n      name: 'Enable all',\n      icon: /*#__PURE__*/React.createElement(EuiIcon, {\n        type: \"eye\",\n        size: \"m\"\n      }),\n      onClick: () => {\n        props.setFilters(props.filters.map(filter => ({ ...filter,\n          disabled: filter.locked ? filter.disabled : false\n        })));\n      }\n    }, {\n      name: 'Disable all',\n      icon: /*#__PURE__*/React.createElement(EuiIcon, {\n        type: \"eyeClosed\",\n        size: \"m\"\n      }),\n      onClick: () => {\n        props.setFilters(props.filters.map(filter => ({ ...filter,\n          disabled: filter.locked ? filter.disabled : true\n        })));\n      }\n    }, {\n      name: 'Invert inclusion',\n      icon: /*#__PURE__*/React.createElement(EuiIcon, {\n        type: \"invert\",\n        size: \"m\"\n      }),\n      onClick: () => {\n        props.setFilters( // if filter.custom.query exists, it's a customized filter and \"inverted\" is alwasy false\n        props.filters.map(filter => {\n          var _filter$custom;\n\n          return { ...filter,\n            inverted: filter.locked ? filter.inverted : (_filter$custom = filter.custom) !== null && _filter$custom !== void 0 && _filter$custom.query ? false : !filter.inverted\n          };\n        }));\n      }\n    }, {\n      name: 'Invert enabled/disabled',\n      icon: /*#__PURE__*/React.createElement(EuiIcon, {\n        type: \"eye\",\n        size: \"m\"\n      }),\n      onClick: () => {\n        props.setFilters(props.filters.map(filter => ({ ...filter,\n          disabled: filter.locked ? filter.disabled : !filter.disabled\n        })));\n      }\n    }, {\n      name: 'Remove all',\n      icon: /*#__PURE__*/React.createElement(EuiIcon, {\n        type: \"trash\",\n        size: \"m\"\n      }),\n      onClick: () => {\n        props.setFilters([]);\n      }\n    }]\n  }];\n\n  const getFilterPopoverPanels = (filter, index, closePopover) => {\n    var _filter$custom2, _filter$custom3;\n\n    return [{\n      id: 0,\n      items: [{\n        name: 'Edit filter',\n        icon: /*#__PURE__*/React.createElement(EuiIcon, {\n          type: \"invert\",\n          size: \"m\"\n        }),\n        disabled: !!((_filter$custom2 = filter.custom) !== null && _filter$custom2 !== void 0 && _filter$custom2.query) || validFilterFields.indexOf(filter.field) === -1,\n        panel: 1\n      }, {\n        name: `${filter.inverted ? 'Include' : 'Exclude'} results`,\n        icon: /*#__PURE__*/React.createElement(EuiIcon, {\n          type: filter.inverted ? 'plusInCircle' : 'minusInCircle',\n          size: \"m\"\n        }),\n        disabled: !!((_filter$custom3 = filter.custom) !== null && _filter$custom3 !== void 0 && _filter$custom3.query) || validFilterFields.indexOf(filter.field) === -1,\n        onClick: () => {\n          filter.inverted = !filter.inverted;\n          setFilter(filter, index);\n        }\n      }, {\n        name: filter.disabled ? 'Re-enable' : 'Temporarily disable',\n        icon: /*#__PURE__*/React.createElement(EuiIcon, {\n          type: filter.disabled ? 'eye' : 'eyeClosed',\n          size: \"m\"\n        }),\n        disabled: validFilterFields.indexOf(filter.field) === -1,\n        onClick: () => {\n          filter.disabled = !filter.disabled;\n          setFilter(filter, index);\n        }\n      }, {\n        name: 'Delete',\n        icon: /*#__PURE__*/React.createElement(EuiIcon, {\n          type: \"trash\",\n          size: \"m\"\n        }),\n        onClick: () => setFilter(null, index)\n      }]\n    }, {\n      id: 1,\n      width: 430,\n      title: 'Edit filter',\n      content: /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          margin: 15\n        }\n      }, /*#__PURE__*/React.createElement(FilterEditPopover, {\n        filterFieldOptions: filterFieldOptions,\n        filter: filter,\n        index: index,\n        setFilter: setFilter,\n        closePopover: closePopover\n      }))\n    }];\n  };\n\n  const GlobalFilterButton = () => {\n    const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n    return /*#__PURE__*/React.createElement(EuiPopover, {\n      isOpen: isPopoverOpen,\n      closePopover: () => setIsPopoverOpen(false),\n      button: /*#__PURE__*/React.createElement(EuiButtonIcon, {\n        onClick: () => setIsPopoverOpen(true),\n        iconType: \"filter\",\n        title: \"Change all filters\",\n        \"aria-label\": \"Change all filters\"\n      }),\n      anchorPosition: \"rightUp\",\n      panelPaddingSize: \"none\",\n      withTitle: true\n    }, /*#__PURE__*/React.createElement(EuiContextMenu, {\n      initialPanelId: 0,\n      panels: globalPopoverPanels\n    }));\n  };\n\n  const AddFilterButton = () => {\n    const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n    const button = /*#__PURE__*/React.createElement(EuiButtonEmpty, {\n      size: \"xs\",\n      onClick: () => {\n        setIsPopoverOpen(true);\n      }\n    }, \"+ Add filter\");\n    return /*#__PURE__*/React.createElement(EuiPopover, {\n      button: button,\n      isOpen: isPopoverOpen,\n      closePopover: () => setIsPopoverOpen(false),\n      anchorPosition: \"downLeft\",\n      withTitle: true\n    }, /*#__PURE__*/React.createElement(EuiPopoverTitle, null, 'Add filter'), /*#__PURE__*/React.createElement(FilterEditPopover, {\n      filterFieldOptions: filterFieldOptions,\n      index: props.filters.length,\n      setFilter: setFilter,\n      closePopover: () => setIsPopoverOpen(false)\n    }));\n  };\n\n  const renderFilters = () => {\n    const FilterBadge = ({\n      filter,\n      index\n    }) => {\n      const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n      const disabled = filter.locked || filter.disabled;\n      const className = 'globalFilterItem' + (disabled ? ' globalFilterItem-isDisabled' : '') + (filter.inverted ? ' globalFilterItem-isExcluded' : '');\n      const value = typeof filter.value === 'string' ? filter.value : `${filter.value.from} to ${filter.value.to}`;\n      const filterLabel = filter.inverted ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiTextColor, {\n        color: disabled ? 'default' : 'danger'\n      }, 'NOT '), /*#__PURE__*/React.createElement(EuiTextColor, {\n        color: \"default\"\n      }, `${filter.field}: ${value}`)) : `${filter.field}: ${value}`;\n      const badge = /*#__PURE__*/React.createElement(EuiBadge, {\n        className: className,\n        onClick: () => setIsPopoverOpen(true),\n        onClickAriaLabel: \"Open filter settings\",\n        color: disabled ? '#e7e9f0' : 'hollow',\n        iconType: \"cross\",\n        iconSide: \"right\",\n        iconOnClick: () => {\n          setFilter(null, index);\n        },\n        iconOnClickAriaLabel: \"Remove filter\"\n      }, filterLabel);\n      return /*#__PURE__*/React.createElement(EuiFlexItem, {\n        grow: false,\n        key: `filter-${index}`\n      }, /*#__PURE__*/React.createElement(EuiPopover, {\n        isOpen: isPopoverOpen,\n        closePopover: () => setIsPopoverOpen(false),\n        panelPaddingSize: \"none\",\n        button: badge\n      }, /*#__PURE__*/React.createElement(EuiContextMenu, {\n        initialPanelId: 0,\n        panels: getFilterPopoverPanels(filter, index, () => setIsPopoverOpen(false))\n      })));\n    };\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, props.filters.length > 0 ? props.filters.map((filter, i) => /*#__PURE__*/React.createElement(FilterBadge, {\n      filter: filter,\n      index: i,\n      key: i\n    })) : null);\n  };\n\n  const filterComponents = useMemo(() => renderFilters(), [props.filters]);\n  return /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"xs\",\n    alignItems: \"center\",\n    responsive: false,\n    style: {\n      minHeight: 32\n    }\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(GlobalFilterButton, null)), filterComponents, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(AddFilterButton, null)));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport dateMath from '@elastic/datemath';\nimport { EuiButton, EuiEmptyPrompt, EuiSpacer, EuiText } from '@elastic/eui';\nimport React from 'react';\nimport { DOCUMENTATION_LINK, RAW_INDEX_NAME, SERVICE_MAP_INDEX_NAME } from '../../../common';\nimport { serviceMapColorPalette } from './color_palette';\nexport function PanelTitle({\n  title,\n  totalItems\n}) {\n  return /*#__PURE__*/React.createElement(EuiText, {\n    size: \"m\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"panel-title\"\n  }, title), totalItems === 0 || totalItems ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"panel-title-count\"\n  }, ` (${totalItems})`) : null);\n}\nexport function NoMatchMessage(props) {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: props.size\n  }), /*#__PURE__*/React.createElement(EuiEmptyPrompt, {\n    title: /*#__PURE__*/React.createElement(\"h2\", null, \"No matches\"),\n    body: /*#__PURE__*/React.createElement(EuiText, null, \"No data matches the selected filter. Clear the filter and/or increase the time range to see more results.\")\n  }), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: props.size\n  }));\n}\nexport function MissingConfigurationMessage() {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiEmptyPrompt, {\n    title: /*#__PURE__*/React.createElement(\"h2\", null, \"Trace Analytics not set up\"),\n    body: /*#__PURE__*/React.createElement(EuiText, null, `The indices required for trace analytics (${RAW_INDEX_NAME} and ${SERVICE_MAP_INDEX_NAME}) do not exist or you do not have permission to access them.`),\n    actions: /*#__PURE__*/React.createElement(EuiButton, {\n      color: \"primary\",\n      iconSide: \"right\",\n      iconType: \"popout\",\n      onClick: () => window.open(DOCUMENTATION_LINK, '_blank')\n    }, \"Learn more\")\n  }));\n}\nexport function renderBenchmark(value) {\n  if (typeof value !== 'number') return null;\n  const benchmarkColor = value === 0 ? '#9ea8a9' : value > 0 ? '#c23f25' : '#3f7e23';\n  const benchmarkArrow = value === 0 ? '-' : value > 0 ? '\\u25B4' : '\\u25BE';\n  return /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    style: {\n      color: benchmarkColor\n    }\n  }, `${Math.abs(value)}% ${benchmarkArrow}`);\n}\nexport function nanoToMilliSec(nano) {\n  if (typeof nano !== 'number') return 0;\n  return nano / 1000000;\n}\nexport function milliToNanoSec(ms) {\n  if (typeof ms !== 'number') return 0;\n  return ms * 1000000;\n}\nexport function getServiceMapScaleColor(percent, idSelected) {\n  return serviceMapColorPalette[idSelected][Math.min(100, Math.max(0, Math.floor(percent * 100)))];\n} // construct vis-js graph from ServiceObject\n\nexport function getServiceMapGraph(map, idSelected, ticks, currService, relatedServices) {\n  if (!relatedServices) relatedServices = Object.keys(map);\n  const nodes = Object.keys(map).map(service => {\n    const value = map[service][idSelected];\n    let color = '140, 148, 169';\n\n    if (value || value === 0) {\n      const percent = (value - ticks[0]) / (ticks[ticks.length - 1] - ticks[0]);\n      color = getServiceMapScaleColor(percent, idSelected);\n    }\n\n    const message = {\n      latency: 'Average latency: ',\n      error_rate: 'Error rate: ',\n      throughput: 'Throughput: '\n    }[idSelected] + (value >= 0 ? value + (idSelected === 'latency' ? 'ms' : idSelected === 'error_rate' ? '%' : '') : 'N/A');\n    return {\n      id: map[service].id,\n      label: service,\n      size: service === currService ? 30 : 15,\n      title: `<p>${service}</p><p>${message}</p>`,\n      color: relatedServices.indexOf(service) >= 0 ? `rgba(${color}, 1)` : `rgba(${color}, 0.3)`\n    };\n  });\n  const edges = [];\n  Object.keys(map).map(service => {\n    map[service].targetServices.map(target => {\n      edges.push({\n        from: map[service].id,\n        to: map[target].id,\n        color: relatedServices.indexOf(service) >= 0 && relatedServices.indexOf(target) >= 0 ? 'rgba(0, 0, 0, 1)' : 'rgba(0, 0, 0, 0.3)'\n      });\n    });\n  });\n  return {\n    graph: {\n      nodes,\n      edges\n    }\n  };\n} // returns flattened targetResource as an array for all traceGroups\n\nexport function getServiceMapTargetResources(map, serviceName) {\n  return [].concat.apply([], [...map[serviceName].traceGroups.map(traceGroup => [...traceGroup.targetResource])]);\n}\nexport function calculateTicks(min, max, numTicks = 5) {\n  if (min >= max) return calculateTicks(0, Math.max(1, max), numTicks);\n  const range = max - min;\n  const minInterval = range / numTicks;\n  const magnitude = Math.pow(10, Math.floor(Math.log10(minInterval)));\n  const residue = Math.ceil(minInterval / magnitude);\n  let tick = magnitude;\n  if (residue > 5) tick *= 10;else if (residue > 2) tick *= 5;else if (residue > 1) tick *= 2;\n  let curr = Math.max(0, Math.floor((min - 1) / tick) * tick);\n  const ticks = [curr];\n\n  while (curr < max) {\n    curr += tick;\n    ticks.push(curr);\n  }\n\n  return ticks;\n} // calculates the minimum fixed_interval for date_histogram from time filter\n\nexport const minFixedInterval = (startTime, endTime) => {\n  if ((startTime === null || startTime === void 0 ? void 0 : startTime.length) === 0 || (endTime === null || endTime === void 0 ? void 0 : endTime.length) === 0 || startTime === endTime) return '1d';\n  const momentStart = dateMath.parse(startTime);\n  const momentEnd = dateMath.parse(endTime);\n  const diffSeconds = momentEnd.unix() - momentStart.unix();\n  if (diffSeconds <= 1) return '1ms'; // less than 1 second\n\n  if (diffSeconds <= 60 * 2) return '1s'; // less than 2 minutes\n\n  if (diffSeconds <= 3600 * 2) return '1m'; // less than 2 hours\n\n  if (diffSeconds <= 86400 * 2) return '1h'; // less than 2 days\n\n  if (diffSeconds <= 86400 * 62) return '1d'; // less than 2 months\n\n  if (diffSeconds <= 86400 * 366) return '30d'; // less than 1 year\n\n  return '365d';\n};\nexport const fixedIntervalToMilli = fixedInterval => {\n  return {\n    '1ms': 1,\n    '1s': 1000,\n    '1m': 60000,\n    '1h': 3600000,\n    '1d': 86400000,\n    '30d': 86400000 * 30,\n    '365d': 86400000 * 365\n  }[fixedInterval];\n};\nexport const fixedIntervalToTickFormat = fixedInterval => {\n  if (fixedInterval === '1d') return '%b %e, %Y';\n  if (fixedInterval === '30d') return '%b %Y';\n  if (fixedInterval === '365d') return '%Y';\n  return '';\n};\nexport const getPercentileFilter = (percentileMaps, conditionString) => {\n  const DSL = {\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: [],\n        minimum_should_match: 1\n      }\n    }\n  };\n  percentileMaps.forEach(map => {\n    DSL.query.bool.should.push({\n      bool: {\n        must: [{\n          term: {\n            name: {\n              value: map.traceGroupName\n            }\n          }\n        }, {\n          range: {\n            durationInNanos: map.durationFilter\n          }\n        }]\n      }\n    });\n  });\n  return {\n    field: 'Latency percentile within trace group',\n    operator: '',\n    value: conditionString,\n    inverted: false,\n    disabled: false,\n    custom: DSL\n  };\n};\nexport const filtersToDsl = (filters, query, startTime, endTime) => {\n  const DSL = {\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    custom: {\n      timeFilter: [],\n      serviceNames: [],\n      serviceNamesExclude: [],\n      traceGroup: [],\n      traceGroupExclude: [],\n      percentiles: {\n        query: {\n          bool: {\n            should: []\n          }\n        }\n      }\n    }\n  };\n  const timeFilter = {\n    range: {\n      startTime: {\n        gte: startTime,\n        lte: endTime\n      }\n    }\n  };\n  DSL.query.bool.must.push(timeFilter);\n  DSL.custom.timeFilter.push(timeFilter);\n\n  if (query.length > 0) {\n    DSL.query.bool.must.push({\n      query_string: {\n        query\n      }\n    });\n  }\n\n  filters.filter(filter => !filter.disabled && !filter.locked).forEach(filter => {\n    var _filter$custom;\n\n    if ((_filter$custom = filter.custom) !== null && _filter$custom !== void 0 && _filter$custom.query) {\n      // add percentile filter\n      DSL.query.bool.should.push(...filter.custom.query.bool.should);\n      DSL.custom.percentiles.query.bool.should.push(...filter.custom.query.bool.should);\n      DSL.query.bool.minimum_should_match = filter.custom.query.bool.minimum_should_match;\n      DSL.custom.percentiles.query.bool.minimum_should_match = filter.custom.query.bool.minimum_should_match;\n      return;\n    }\n\n    if (filter.field === 'serviceName' && (filter.operator === 'is' || filter.operator === 'is not')) {\n      DSL.custom[filter.inverted ? 'serviceNamesExclude' : 'serviceNames'].push(filter.value);\n    }\n\n    if (filter.field === 'traceGroup') {\n      DSL.custom[filter.inverted ? 'traceGroupExclude' : 'traceGroup'].push(filter.value);\n    }\n\n    let filterQuery = {};\n\n    switch (filter.operator) {\n      case 'exists':\n      case 'does not exist':\n        filterQuery = {\n          exists: {\n            field: filter.field\n          }\n        };\n        break;\n\n      case 'is':\n      case 'is not':\n        filterQuery = {\n          term: {\n            [filter.field]: filter.value\n          }\n        };\n        break;\n\n      case 'is between':\n      case 'is not between':\n        const range = {};\n        if (!filter.value.from.includes('\\u221E')) range.gte = filter.value.from;\n        if (!filter.value.to.includes('\\u221E')) range.lte = filter.value.to;\n        filterQuery = {\n          range: {\n            [filter.field]: range\n          }\n        };\n        break;\n\n      default:\n        break;\n    }\n\n    DSL.query.bool[filter.inverted ? 'must_not' : 'must'].push(filterQuery);\n  });\n  return DSL;\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport * from './helper_functions';\nexport { SearchBar, SearchBarProps, renderDatePicker } from './search_bar';\nexport { Plt } from './plots/plt';","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFlexGrid, EuiFlexItem, EuiText, EuiToolTip } from '@elastic/eui';\nimport React, { useMemo, useState } from 'react';\nimport { Plt } from './plt';\nexport function BoxPlt({\n  plotParams\n}) {\n  const [hovered, setHovered] = useState('');\n\n  const getLayout = () => ({\n    plot_bgcolor: 'rgba(0, 0, 0, 0)',\n    paper_bgcolor: 'rgba(0, 0, 0, 0)',\n    xaxis: {\n      range: [plotParams.min, plotParams.max],\n      fixedrange: true,\n      showgrid: false,\n      visible: false\n    },\n    yaxis: {\n      range: [-0.6, 0.6],\n      fixedrange: true,\n      showgrid: false,\n      visible: false\n    },\n    margin: {\n      l: 0,\n      r: 0,\n      b: 0,\n      t: 0,\n      pad: 0\n    },\n    height: 15,\n    width: 250\n  });\n\n  const getData = () => [{\n    x: [plotParams.left],\n    y: [0],\n    type: 'bar',\n    orientation: 'h',\n    width: 1,\n    marker: {\n      color: 'rgba(0, 0, 0, 0)'\n    },\n    hoverinfo: 'none',\n    showlegend: false\n  }, {\n    x: [plotParams.mid - plotParams.left],\n    y: [0],\n    type: 'bar',\n    orientation: 'h',\n    width: 1,\n    marker: {\n      color: plotParams.currPercentileFilter === '< 95th' ? '#fcfcfc' : '#ffffff',\n      line: {\n        color: plotParams.currPercentileFilter === '< 95th' ? '#eceded' : hovered === 'lower' ? '#2e73b5' : '#957ac9',\n        width: hovered === 'lower' ? 3 : 1\n      }\n    }\n  }, {\n    x: [plotParams.right - plotParams.mid],\n    y: [0],\n    type: 'bar',\n    orientation: 'h',\n    width: 1,\n    marker: {\n      color: plotParams.currPercentileFilter === '>= 95th' ? '#aea4d1' : '#957ac9',\n      line: {\n        color: hovered === 'upper' ? '#2e73b5' : '#957ac9',\n        width: hovered === 'upper' ? 3 : 1\n      }\n    }\n  }];\n\n  const renderTooltip = () => {\n    return /*#__PURE__*/React.createElement(EuiFlexGrid, {\n      columns: 2,\n      gutterSize: \"s\",\n      responsive: false\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\",\n      style: {\n        color: hovered === 'lower' ? '#ffffff' : '#c9cbce'\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", null, \"Latency <95 percentile\"))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\",\n      style: {\n        color: hovered === 'lower' ? '#ffffff' : '#c9cbce'\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", null, `${Math.round(plotParams.left)}ms - ${Math.round(plotParams.mid)}ms`))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\",\n      style: {\n        color: hovered === 'upper' ? '#ffffff' : '#c9cbce'\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", null, \"Latency >=95 percentile\"))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\",\n      style: {\n        color: hovered === 'upper' ? '#ffffff' : '#c9cbce'\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", null, `${Math.round(plotParams.mid)}ms - ${Math.round(plotParams.right)}ms`))));\n  };\n\n  const layout = useMemo(() => getLayout(), [plotParams]);\n  const data = useMemo(() => getData(), [plotParams, hovered]);\n  const tooltip = useMemo(() => renderTooltip(), [plotParams, hovered]);\n\n  const onHoverHandler = e => {\n    if (plotParams.currPercentileFilter) return;\n    const mouseX = e.xvals[0];\n    if (plotParams.left <= mouseX && mouseX <= plotParams.mid) setHovered('lower');else if (plotParams.mid <= mouseX && mouseX <= plotParams.right) setHovered('upper');else setHovered('');\n  };\n\n  const onClickHandler = e => {\n    if (plotParams.currPercentileFilter) return;\n    if (e.points[0].fullData.index === 1) plotParams.addFilter('lte');else if (e.points[0].fullData.index === 2) plotParams.addFilter('gte');\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiToolTip, {\n    content: tooltip,\n    position: \"bottom\",\n    onMouseOut: () => setHovered('')\n  }, /*#__PURE__*/React.createElement(Plt, {\n    data: data,\n    layout: layout,\n    onHoverHandler: onHoverHandler,\n    onClickHandler: onClickHandler\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiHorizontalRule, EuiPanel } from '@elastic/eui';\nimport moment from 'moment';\nimport React, { useMemo } from 'react';\nimport { fixedIntervalToMilli, fixedIntervalToTickFormat, NoMatchMessage, PanelTitle } from '..';\nimport { Plt } from './plt';\nexport function ErrorRatePlt(props) {\n  var _props$items, _props$items$items;\n\n  const getLayout = () => {\n    var _props$items$items$, _props$items$items$2, _props$items$items$3, _props$items$items$4, _props$items$items$5;\n\n    return {\n      height: 217,\n      margin: {\n        l: 57,\n        r: 5,\n        b: 50,\n        t: 30,\n        pad: 4\n      },\n      annotations: props.items.items.length > 0 && [{\n        x: (_props$items$items$ = props.items.items[0]) === null || _props$items$items$ === void 0 ? void 0 : _props$items$items$.x[((_props$items$items$2 = props.items.items[0]) === null || _props$items$items$2 === void 0 ? void 0 : _props$items$items$2.x.length) - 1],\n        y: 0,\n        showarrow: true,\n        arrowhead: 0,\n        xref: 'x',\n        yref: 'y',\n        text: `Now: ${(_props$items$items$3 = props.items.items[0]) === null || _props$items$items$3 === void 0 ? void 0 : _props$items$items$3.y[((_props$items$items$4 = props.items.items[0]) === null || _props$items$items$4 === void 0 ? void 0 : _props$items$items$4.y.length) - 1]}%`,\n        ax: 0,\n        ay: -160,\n        borderpad: 10,\n        arrowwidth: 0.7\n      }],\n      showlegend: false,\n      xaxis: {\n        fixedrange: true,\n        showgrid: false,\n        visible: true,\n        type: 'date',\n        tickformat: fixedIntervalToTickFormat(props.items.fixedInterval),\n        color: '#899195'\n      },\n      yaxis: {\n        title: {\n          text: 'Error rate (%)',\n          font: {\n            size: 12\n          },\n          standoff: 10\n        },\n        range: [0, Math.min(100, Math.max(...(((_props$items$items$5 = props.items.items[0]) === null || _props$items$items$5 === void 0 ? void 0 : _props$items$items$5.y.map(y => y * 1.2)) || []), 1))],\n        fixedrange: true,\n        ticksuffix: '%',\n        gridcolor: '#d9d9d9',\n        showgrid: true,\n        visible: true,\n        color: '#899195'\n      }\n    };\n  };\n\n  const layout = useMemo(() => getLayout(), [props.items]);\n\n  const onClick = event => {\n    if (!(event !== null && event !== void 0 && event.points)) return;\n    const point = event.points[0];\n    const start = point.data.x[point.pointNumber];\n    const end = start + fixedIntervalToMilli(props.items.fixedInterval);\n    props.setStartTime(moment(start).toISOString());\n    props.setEndTime(moment(end).toISOString());\n    window.scrollTo({\n      left: 0,\n      top: 0,\n      behavior: 'smooth'\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, {\n    style: {\n      minWidth: 433,\n      minHeight: 308\n    }\n  }, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Error rate over time\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), ((_props$items = props.items) === null || _props$items === void 0 ? void 0 : (_props$items$items = _props$items.items) === null || _props$items$items === void 0 ? void 0 : _props$items$items.length) > 0 ? /*#__PURE__*/React.createElement(Plt, {\n    data: props.items.items,\n    layout: layout,\n    onClickHandler: onClick\n  }) : /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"s\"\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport _ from 'lodash';\nimport React, { useMemo } from 'react';\nimport { Plt } from './plt';\nexport function LinePlt(props) {\n  var _props$data$;\n\n  const maxY = (_props$data$ = props.data[0]) !== null && _props$data$ !== void 0 && _props$data$.y ? Math.max(...props.data[0].y) : 0;\n  const layout = useMemo(() => ({\n    plot_bgcolor: 'rgba(0, 0, 0, 0)',\n    paper_bgcolor: 'rgba(0, 0, 0, 0)',\n    xaxis: {\n      fixedrange: true,\n      showgrid: false,\n      visible: false\n    },\n    yaxis: {\n      fixedrange: true,\n      showgrid: false,\n      visible: false,\n      range: [0, maxY * 1.1]\n    },\n    margin: {\n      l: 0,\n      r: 0,\n      b: 0,\n      t: 0,\n      pad: 0\n    },\n    height: 20,\n    width: 60\n  }), [props.data]);\n  return props.data[0].x.length > 1 ? /*#__PURE__*/React.createElement(Plt, {\n    data: props.data,\n    layout: layout\n  }) : /*#__PURE__*/React.createElement(\"div\", null, \"-\");\n}\nexport function LatencyPlt(props) {\n  const layout = useMemo(() => ({\n    xaxis: {\n      showgrid: false,\n      type: 'date',\n      tickmode: 'auto',\n      color: '#899195'\n    },\n    yaxis: {\n      title: {\n        text: 'Hourly latency (ms)',\n        font: {\n          size: 12\n        }\n      },\n      gridcolor: '#d9d9d9',\n      color: '#899195'\n    },\n    annotations: [{\n      x: props.data[0].x[props.data[0].x.length - 1],\n      y: 0,\n      showarrow: true,\n      arrowhead: 0,\n      xref: 'x',\n      yref: 'y',\n      text: `Now: ${_.round(props.data[0].y[props.data[0].y.length - 1], 2)}ms`,\n      ax: 0,\n      ay: -140,\n      borderpad: 10,\n      arrowwidth: 0.7\n    }],\n    margin: {\n      l: 50,\n      r: 30,\n      b: 50,\n      t: 30,\n      pad: 0\n    },\n    height: 200,\n    width: 400\n  }), [props.data]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Plt, {\n    data: props.data,\n    layout: layout\n  }));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport React from 'react';\nimport plotComponentFactory from 'react-plotly.js/factory';\nimport Plotly from 'plotly.js-dist';\nexport function Plt(props) {\n  const PlotComponent = plotComponentFactory(Plotly);\n  return /*#__PURE__*/React.createElement(PlotComponent, {\n    data: props.data,\n    style: {\n      width: '100%',\n      height: '100%'\n    },\n    onHover: props.onHoverHandler,\n    onClick: props.onClickHandler,\n    useResizeHandler: true,\n    config: {\n      displayModeBar: false\n    },\n    layout: {\n      autosize: true,\n      margin: {\n        l: 30,\n        r: 5,\n        b: 30,\n        t: 5,\n        pad: 4\n      },\n      barmode: 'stack',\n      legend: {\n        orientation: 'h',\n        traceorder: 'normal'\n      },\n      showlegend: false,\n      hovermode: 'closest',\n      xaxis: {\n        showgrid: true,\n        zeroline: false,\n        rangemode: 'normal'\n      },\n      yaxis: {\n        showgrid: true,\n        zeroline: false,\n        rangemode: 'normal'\n      },\n      ...props.layout\n    }\n  });\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButtonGroup, EuiFieldSearch, EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiPanel, EuiSpacer, EuiText } from '@elastic/eui';\nimport React, { useEffect, useState } from 'react';\nimport Graph from 'react-graph-vis';\nimport { calculateTicks, getServiceMapGraph, NoMatchMessage, PanelTitle } from '..';\nimport { ServiceMapScale } from './service_map_scale';\nexport function ServiceMap({\n  serviceMap,\n  idSelected,\n  setIdSelected,\n  addFilter,\n  currService\n}) {\n  const [invalid, setInvalid] = useState(false);\n  const [network, setNetwork] = useState(null);\n  const [ticks, setTicks] = useState([]);\n  const [items, setItems] = useState({});\n  const [query, setQuery] = useState('');\n  const toggleButtons = [{\n    id: 'latency',\n    label: 'Latency'\n  }, {\n    id: 'error_rate',\n    label: 'Error rate'\n  }, {\n    id: 'throughput',\n    label: 'Throughput'\n  }];\n  const options = {\n    layout: {\n      hierarchical: false\n    },\n    edges: {\n      arrows: {\n        to: {\n          enabled: false\n        }\n      },\n      physics: false\n    },\n    nodes: {\n      shape: 'dot',\n      color: '#adadad',\n      borderWidth: 0,\n      font: {\n        size: 17,\n        color: '#387ab9'\n      }\n    },\n    interaction: {\n      hover: true,\n      tooltipDelay: 30,\n      selectable: true\n    },\n    manipulation: {\n      enabled: false\n    },\n    height: '434px',\n    width: '100%',\n    autoResize: true\n  };\n  const events = {\n    select: event => {\n      var _items$graph$nodes$fi;\n\n      const {\n        nodes,\n        edges\n      } = event;\n      if (!addFilter || !nodes) return;\n      const serviceName = items === null || items === void 0 ? void 0 : (_items$graph$nodes$fi = items.graph.nodes.find(node => node.id === nodes[0])) === null || _items$graph$nodes$fi === void 0 ? void 0 : _items$graph$nodes$fi.label;\n\n      if (serviceName) {\n        addFilter({\n          field: 'serviceName',\n          operator: 'is',\n          value: serviceName,\n          inverted: false,\n          disabled: false\n        });\n      }\n    },\n    hoverNode: event => {}\n  };\n\n  const onFocus = (service, networkInstance) => {\n    if (service.length === 0) {\n      setInvalid(false);\n    } else if (serviceMap[service]) {\n      if (!networkInstance) networkInstance = network;\n      networkInstance.focus(serviceMap[service].id, {\n        animation: true\n      });\n      setInvalid(false);\n    } else {\n      setInvalid(true);\n    }\n  };\n\n  useEffect(() => {\n    var _serviceMap$currServi;\n\n    if (Object.keys(serviceMap).length === 0) return;\n    const values = Object.keys(serviceMap).map(service => serviceMap[service][idSelected] || null).filter(val => val !== null);\n    const min = Math.min(...values);\n    const max = Math.max(...values);\n    const calculatedTicks = calculateTicks(min, max);\n    setTicks(calculatedTicks);\n    setItems(getServiceMapGraph(serviceMap, idSelected, calculatedTicks, currService, (_serviceMap$currServi = serviceMap[currService]) === null || _serviceMap$currServi === void 0 ? void 0 : _serviceMap$currServi.relatedServices));\n  }, [serviceMap, idSelected]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Service map\"\n  }), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiButtonGroup, {\n    options: toggleButtons,\n    idSelected: idSelected,\n    onChange: id => setIdSelected(id),\n    buttonSize: \"s\",\n    color: \"text\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    alignItems: \"center\",\n    gutterSize: \"s\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, null, \"Focus on\")), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFieldSearch, {\n    placeholder: \"Service name\",\n    value: query,\n    onChange: e => setQuery(e.target.value),\n    onSearch: service => onFocus(service),\n    isInvalid: query.length > 0 && invalid\n  }))), /*#__PURE__*/React.createElement(EuiSpacer, null), Object.keys(serviceMap).length > 0 ? /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"none\",\n    responsive: false\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, null, (items === null || items === void 0 ? void 0 : items.graph) && /*#__PURE__*/React.createElement(Graph, {\n    graph: items.graph,\n    options: options,\n    events: events,\n    getNetwork: networkInstance => {\n      setNetwork(networkInstance);\n      if (currService) onFocus(currService, networkInstance);\n    }\n  })), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(ServiceMapScale, {\n    idSelected: idSelected,\n    serviceMap: serviceMap,\n    ticks: ticks\n  }))) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      minHeight: 434\n    }\n  }, /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"s\"\n  }))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { getServiceMapScaleColor } from '..';\nimport { Plt } from './plt';\nexport function ServiceMapScale(props) {\n  const [scaleProps, setScaleProps] = useState({});\n\n  const getScaleData = () => {\n    const ticks = props.ticks;\n    const delta = ticks[1] - ticks[0];\n    const title = {\n      latency: 'Latency (ms)',\n      error_rate: 'Error rate',\n      throughput: 'Throughput'\n    }[props.idSelected];\n    const percentInterval = 1 / Math.max(ticks.length - 1, 1);\n    const percents = Array.from({\n      length: ticks.length - 1\n    }, (v, i) => percentInterval * i);\n    const color = percents.map(percent => getServiceMapScaleColor(percent, props.idSelected)).map(rgb => `rgb(${rgb})`);\n    const result = {\n      data: {\n        y: [delta + ticks[0], ...Array.from({\n          length: ticks.length - 1\n        }, () => delta)],\n        marker: {\n          color\n        }\n      },\n      layout: {\n        yaxis: {\n          range: [ticks[0], ticks[ticks.length - 1]],\n          ticksuffix: props.idSelected === 'error_rate' ? '%' : '',\n          title: {\n            text: title,\n            standoff: 15\n          }\n        }\n      }\n    };\n    return result;\n  };\n\n  const getScaleProps = () => {\n    const result = getScaleData();\n    const data = [{\n      x: Array.from({\n        length: result.data.y.length\n      }, () => 0),\n      type: 'bar',\n      orientation: 'v',\n      width: 0.4,\n      hoverinfo: 'none',\n      showlegend: false,\n      ...result.data\n    }];\n\n    const layout = _.merge({\n      plot_bgcolor: 'rgba(0, 0, 0, 0)',\n      paper_bgcolor: 'rgba(0, 0, 0, 0)',\n      xaxis: {\n        range: [-0.35, 0.35],\n        fixedrange: true,\n        showgrid: false,\n        showline: false,\n        zeroline: false,\n        showticklabels: false\n      },\n      yaxis: {\n        side: 'right',\n        fixedrange: true,\n        showgrid: false,\n        showline: false,\n        zeroline: false,\n        showticklabels: true,\n        tickvals: props.ticks,\n        ticktexts: props.ticks\n      },\n      margin: {\n        l: 0,\n        r: 60,\n        b: 10,\n        t: 10,\n        pad: 0\n      },\n      height: 270,\n      width: 77\n    }, result.layout);\n\n    return {\n      data,\n      layout\n    };\n  };\n\n  useEffect(() => {\n    if (Object.keys(props.ticks).length > 0) setScaleProps(getScaleProps());\n  }, [props.idSelected, props.serviceMap, props.ticks]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      minHeight: 400,\n      minWidth: 65\n    }\n  }, Object.keys(props.ticks).length > 0 && /*#__PURE__*/React.createElement(Plt, scaleProps));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiHorizontalRule, EuiPanel } from '@elastic/eui';\nimport moment from 'moment';\nimport React, { useMemo } from 'react';\nimport { fixedIntervalToMilli, fixedIntervalToTickFormat, NoMatchMessage, PanelTitle } from '..';\nimport { Plt } from './plt';\nexport function ThroughputPlt(props) {\n  var _props$items, _props$items$items;\n\n  const layout = useMemo(() => {\n    var _props$items$items$0$;\n\n    return {\n      height: 217,\n      margin: {\n        l: 50,\n        r: 5,\n        b: 50,\n        t: 30,\n        pad: 4\n      },\n      annotations: props.items.items.length > 0 && [{\n        x: props.items.items[0].x[props.items.items[0].x.length - 1],\n        y: 0,\n        showarrow: true,\n        arrowhead: 0,\n        xref: 'x',\n        yref: 'y',\n        text: `Now: ${(_props$items$items$0$ = props.items.items[0].y[props.items.items[0].y.length - 1]) === null || _props$items$items$0$ === void 0 ? void 0 : _props$items$items$0$.toLocaleString(undefined)}`,\n        ax: 0,\n        ay: -160,\n        borderpad: 10,\n        arrowwidth: 0.7\n      }],\n      xaxis: {\n        fixedrange: true,\n        showgrid: false,\n        visible: true,\n        type: 'date',\n        tickformat: fixedIntervalToTickFormat(props.items.fixedInterval),\n        color: '#899195'\n      },\n      yaxis: {\n        title: {\n          text: 'Throughput (n)',\n          font: {\n            size: 12\n          }\n        },\n        fixedrange: true,\n        gridcolor: '#d9d9d9',\n        showgrid: true,\n        visible: true,\n        color: '#899195'\n      }\n    };\n  }, [props.items]);\n\n  const onClick = event => {\n    if (!(event !== null && event !== void 0 && event.points)) return;\n    const point = event.points[0];\n    const start = point.data.x[point.pointNumber];\n    const end = start + fixedIntervalToMilli(props.items.fixedInterval);\n    props.setStartTime(moment(start).toISOString());\n    props.setEndTime(moment(end).toISOString());\n    window.scrollTo({\n      left: 0,\n      top: 0,\n      behavior: 'smooth'\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, {\n    style: {\n      minWidth: 433,\n      minHeight: 308\n    }\n  }, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Throughput over time\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), ((_props$items = props.items) === null || _props$items === void 0 ? void 0 : (_props$items$items = _props$items.items) === null || _props$items$items === void 0 ? void 0 : _props$items$items.length) > 0 ? /*#__PURE__*/React.createElement(Plt, {\n    data: props.items.items,\n    layout: layout,\n    onClickHandler: onClick\n  }) : /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"s\"\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButton, EuiFieldSearch, EuiFlexGroup, EuiFlexItem, EuiSpacer, EuiSuperDatePicker } from '@elastic/eui';\nimport _ from 'lodash';\nimport React, { useState } from 'react';\nimport { Filters } from './filters/filters';\nexport const renderDatePicker = (startTime, setStartTime, endTime, setEndTime) => {\n  return /*#__PURE__*/React.createElement(EuiSuperDatePicker, {\n    start: startTime,\n    end: endTime,\n    showUpdateButton: false,\n    onTimeChange: e => {\n      setStartTime(e.start);\n      setEndTime(e.end);\n    }\n  });\n};\nexport function SearchBar(props) {\n  // use another query state to avoid typing delay\n  const [query, setQuery] = useState(props.query);\n\n  const setGlobalQuery = _.debounce(q => props.setQuery(q), 50);\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"s\"\n  }, !props.datepickerOnly && /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFieldSearch, {\n    fullWidth: true,\n    isClearable: false,\n    placeholder: \"Trace ID, trace group name\",\n    value: query,\n    onChange: e => {\n      setQuery(e.target.value);\n      setGlobalQuery(e.target.value);\n    },\n    onSearch: props.refresh\n  })), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, renderDatePicker(props.startTime, props.setStartTime, props.endTime, props.setEndTime)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiButton, {\n    fill: true,\n    iconType: \"refresh\",\n    onClick: props.refresh\n  }, \"Refresh\"))), !props.datepickerOnly && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"s\"\n  }), /*#__PURE__*/React.createElement(Filters, {\n    page: props.page,\n    filters: props.filters,\n    setFilters: props.setFilters\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiPage, EuiPageBody, EuiPageSideBar, EuiSideNav } from '@elastic/eui';\nimport React from 'react';\nexport const renderPageWithSidebar = (BodyComponent, activeId = 1) => {\n  function SideNav({\n    activeId\n  }) {\n    return /*#__PURE__*/React.createElement(EuiSideNav, {\n      items: [{\n        name: 'Trace Analytics',\n        id: 0,\n        items: [{\n          name: 'Dashboard',\n          id: 1,\n          href: '#/dashboard'\n        }, {\n          name: 'Traces',\n          id: 2,\n          href: '#/traces'\n        }, {\n          name: 'Services',\n          id: 3,\n          href: '#/services'\n        }].map(item => {\n          return { ...item,\n            isSelected: activeId === item.id\n          };\n        })\n      }]\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(EuiPage, null, /*#__PURE__*/React.createElement(EuiPageSideBar, null, /*#__PURE__*/React.createElement(SideNav, {\n    activeId: activeId\n  })), /*#__PURE__*/React.createElement(EuiPageBody, null, BodyComponent));\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFlexGroup, EuiFlexItem, EuiSpacer, EuiTitle } from '@elastic/eui';\nimport React, { useEffect, useState } from 'react';\nimport { handleDashboardErrorRatePltRequest, handleDashboardRequest, handleDashboardThroughputPltRequest } from '../../requests/dashboard_request_handler';\nimport { handleServiceMapRequest } from '../../requests/services_request_handler';\nimport { filtersToDsl, getPercentileFilter, milliToNanoSec, minFixedInterval, MissingConfigurationMessage, SearchBar } from '../common';\nimport { getValidFilterFields } from '../common/filters/filter_helpers';\nimport { ErrorRatePlt } from '../common/plots/error_rate_plt';\nimport { ThroughputPlt } from '../common/plots/throughput_plt';\nimport { DashboardTable } from './dashboard_table';\nexport function Dashboard(props) {\n  const [tableItems, setTableItems] = useState([]);\n  const [throughputPltItems, setThroughputPltItems] = useState({\n    items: [],\n    fixedInterval: '1h'\n  });\n  const [errorRatePltItems, setErrorRatePltItems] = useState({\n    items: [],\n    fixedInterval: '1h'\n  });\n  const [serviceMap, setServiceMap] = useState({});\n  const [serviceMapIdSelected, setServiceMapIdSelected] = useState('latency');\n  const [percentileMap, setPercentileMap] = useState({});\n  const [redirect, setRedirect] = useState(true);\n  useEffect(() => {\n    props.setBreadcrumbs([{\n      text: 'Trace Analytics',\n      href: '#'\n    }, {\n      text: 'Dashboard',\n      href: '#/dashboard'\n    }]);\n    const validFilters = getValidFilterFields('dashboard');\n    props.setFilters([...props.filters.map(filter => ({ ...filter,\n      locked: validFilters.indexOf(filter.field) === -1\n    }))]);\n    setRedirect(false);\n  }, []);\n  useEffect(() => {\n    if (!redirect && props.indicesExist) refresh();\n  }, [props.filters, props.startTime, props.endTime]);\n\n  const refresh = async () => {\n    const DSL = filtersToDsl(props.filters, props.query, props.startTime, props.endTime);\n    const timeFilterDSL = filtersToDsl([], '', props.startTime, props.endTime);\n    const fixedInterval = minFixedInterval(props.startTime, props.endTime);\n    handleDashboardRequest(props.http, DSL, timeFilterDSL, tableItems, setTableItems, setPercentileMap);\n    handleDashboardThroughputPltRequest(props.http, DSL, fixedInterval, throughputPltItems, setThroughputPltItems);\n    handleDashboardErrorRatePltRequest(props.http, DSL, fixedInterval, errorRatePltItems, setErrorRatePltItems);\n    handleServiceMapRequest(props.http, DSL, serviceMap, setServiceMap);\n  };\n\n  const addFilter = filter => {\n    for (const addedFilter of props.filters) {\n      if (addedFilter.field === filter.field && addedFilter.operator === filter.operator && addedFilter.value === filter.value) {\n        return;\n      }\n    }\n\n    const newFilters = [...props.filters, filter];\n    props.setFilters(newFilters);\n  };\n\n  const addPercentileFilter = (condition = 'gte', additionalFilters = []) => {\n    if (tableItems.length === 0 || Object.keys(percentileMap).length === 0) return;\n\n    for (let i = 0; i < props.filters.length; i++) {\n      if (props.filters[i].custom) {\n        const newFilter = JSON.parse(JSON.stringify(props.filters[i]).replace(/{\"range\":{\"durationInNanos\":{\"[gl]te?\"/g, `{\"range\":{\"durationInNanos\":{\"${condition}\"`));\n        newFilter.value = condition === 'gte' ? '>= 95th' : '< 95th';\n        const newFilters = [...props.filters, ...additionalFilters];\n        newFilters.splice(i, 1, newFilter);\n        props.setFilters(newFilters);\n        return;\n      }\n    }\n\n    const percentileMaps = Object.keys(percentileMap).map(traceGroup => ({\n      traceGroupName: traceGroup,\n      durationFilter: {\n        [condition]: milliToNanoSec(percentileMap[traceGroup][1])\n      }\n    }));\n    const percentileFilter = getPercentileFilter(percentileMaps, condition === 'gte' ? '>= 95th' : '< 95th');\n    const newFilters = [...props.filters, percentileFilter, ...additionalFilters];\n    props.setFilters(newFilters);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiTitle, {\n    size: \"l\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      fontWeight: 430\n    }\n  }, \"Dashboard\")), /*#__PURE__*/React.createElement(SearchBar, {\n    query: props.query,\n    filters: props.filters,\n    setFilters: props.setFilters,\n    setQuery: props.setQuery,\n    startTime: props.startTime,\n    setStartTime: props.setStartTime,\n    endTime: props.endTime,\n    setEndTime: props.setEndTime,\n    refresh: refresh,\n    page: \"dashboard\"\n  }), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), props.indicesExist ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DashboardTable, {\n    items: tableItems,\n    filters: props.filters,\n    addFilter: addFilter,\n    addPercentileFilter: addPercentileFilter,\n    setRedirect: setRedirect\n  }), /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    alignItems: \"baseline\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(ErrorRatePlt, {\n    items: errorRatePltItems,\n    setStartTime: props.setStartTime,\n    setEndTime: props.setEndTime\n  })), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(ThroughputPlt, {\n    items: throughputPltItems,\n    setStartTime: props.setStartTime,\n    setEndTime: props.setEndTime\n  })))) : /*#__PURE__*/React.createElement(MissingConfigurationMessage, null));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiI18nNumber, EuiIcon, EuiInMemoryTable, EuiLink, EuiPanel, EuiSpacer, EuiText, EuiToolTip } from '@elastic/eui';\nimport React, { useMemo, useState } from 'react';\nimport _ from 'lodash';\nimport { calculateTicks, NoMatchMessage, PanelTitle } from '../common';\nimport { BoxPlt } from '../common/plots/box_plt';\nimport { LatencyTrendCell } from './latency_trend_cell';\nexport function DashboardTable(props) {\n  var _props$items2;\n\n  const getVarianceProps = items => {\n    if (items.length === 0) {\n      return {\n        minRange: 0,\n        maxRange: 0,\n        ticks: [0, 0],\n        scale: ''\n      };\n    }\n\n    const variances = [].concat(...items.filter(item => item.dashboard_latency_variance).map(item => item.dashboard_latency_variance));\n    const minRange = Math.min(...variances);\n    const maxRange = Math.max(...variances);\n    const ticks = calculateTicks(minRange, maxRange);\n    const maxDigits = ticks[ticks.length - 1].toString().length; // pads spaces (\\u00A0) in between ticks to construct a scale\n    // width of a character equals the width of two spaces, maximum 39 characters in a scale\n\n    const scale = ticks.map(tick => {\n      const tickStr = tick.toString();\n      return tickStr.padEnd(tickStr.length + 2 * (maxDigits - tickStr.length), '\\u00A0');\n    }).join('\\u00A0'.repeat(Math.max(1, Math.floor(2 * (39 - ticks.length * maxDigits) / Math.max(1, ticks.length - 1)))));\n    return {\n      minRange,\n      maxRange,\n      ticks,\n      scale\n    };\n  };\n\n  const getColumns = () => [{\n    field: 'dashboard_trace_group_name',\n    name: /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"Traces of all requests that share a common API and operation at the start of distributed tracing instrumentation.\")\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"Trace group name\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"))),\n    align: 'left',\n    sortable: true,\n    render: item => item ? /*#__PURE__*/React.createElement(EuiLink, {\n      onClick: () => props.addFilter({\n        field: 'traceGroup',\n        operator: 'is',\n        value: item,\n        inverted: false,\n        disabled: false\n      })\n    }, _.truncate(item, {\n      length: 24\n    })) : '-'\n  }, {\n    field: 'dashboard_latency_variance',\n    name: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"Range of latencies for traces within a trace group in the selected time range.\")\n    }, /*#__PURE__*/React.createElement(\"span\", null, \"Latency variance (ms)\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    }))), varianceProps && /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\",\n      color: \"subdued\"\n    }, varianceProps.scale)),\n    align: 'center',\n    sortable: ({\n      dashboard_latency_variance\n    }) => (dashboard_latency_variance === null || dashboard_latency_variance === void 0 ? void 0 : dashboard_latency_variance.length) > 0 ? dashboard_latency_variance[2] - dashboard_latency_variance[0] : 0,\n    width: '300px',\n    render: (item, row) => {\n      const filter = props.filters.find(f => f.field === 'Latency percentile within trace group');\n      const currPercentileFilter = filter ? filter.value : '';\n      return item ?\n      /*#__PURE__*/\n      // expand plot ranges to accomondate scale\n      React.createElement(BoxPlt, {\n        plotParams: {\n          min: varianceProps.ticks.length > 1 ? varianceProps.ticks[0] : varianceProps.ticks[0] / 1.03,\n          max: varianceProps.ticks[varianceProps.ticks.length - 1] * 1.03,\n          left: item[0],\n          mid: item[1],\n          right: item[2],\n          currPercentileFilter,\n          addFilter: condition => {\n            const traceGroupFilter = {\n              field: 'traceGroup',\n              operator: 'is',\n              value: row.dashboard_trace_group_name,\n              inverted: false,\n              disabled: false\n            };\n            const additionalFilters = [traceGroupFilter];\n\n            for (const addedFilter of props.filters) {\n              if (addedFilter.field === traceGroupFilter.field && addedFilter.operator === traceGroupFilter.operator && addedFilter.value === traceGroupFilter.value) {\n                additionalFilters.pop();\n              }\n            }\n\n            props.addPercentileFilter(condition, additionalFilters);\n          }\n        }\n      }) : '-';\n    }\n  }, {\n    field: 'dashboard_average_latency',\n    name: /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"Average latency of traces within a trace group in the selected time range.\")\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"Average latency (ms)\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"))),\n    align: 'right',\n    sortable: true,\n    dataType: 'number',\n    render: item => item === 0 || item ? _.round(item, 2) : '-'\n  }, {\n    field: '24_hour_latency_trend',\n    name: /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"24 hour time series view of hourly average, hourly percentile, and hourly range of latency for traces within a trace group.\")\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"24-hour latency trend\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"))),\n    align: 'right',\n    sortable: false,\n    render: (item, row) => item ? /*#__PURE__*/React.createElement(LatencyTrendCell, {\n      item: item,\n      traceGroupName: row.dashboard_trace_group_name\n    }) : '-'\n  }, {\n    field: 'dashboard_error_rate',\n    name: /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"Error rate based on count of errors on all traces and spans within a trace group in the selected time range (eg. 3 errors on different spans on a single trace counts as 3 errors in this calculation).\")\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"Error rate\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"))),\n    align: 'right',\n    sortable: true,\n    render: item => item === 0 || item ? /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, `${_.round(item, 2)}%`) : '-'\n  }, {\n    field: 'dashboard_traces',\n    name: /*#__PURE__*/React.createElement(EuiToolTip, {\n      content: /*#__PURE__*/React.createElement(EuiText, {\n        size: \"xs\"\n      }, \"Count of traces with unique trace identifiers in the selected time range.\")\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"Traces\", ' ', /*#__PURE__*/React.createElement(EuiIcon, {\n      size: \"s\",\n      color: \"subdued\",\n      type: \"questionInCircle\",\n      className: \"eui-alignTop\"\n    })), /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"))),\n    align: 'right',\n    sortable: true,\n    render: (item, row) => /*#__PURE__*/React.createElement(EuiLink, {\n      onClick: () => {\n        props.setRedirect(true);\n        props.addFilter({\n          field: 'traceGroup',\n          operator: 'is',\n          value: row.dashboard_trace_group_name,\n          inverted: false,\n          disabled: false\n        });\n        location.assign('#/traces');\n      }\n    }, /*#__PURE__*/React.createElement(EuiI18nNumber, {\n      value: item\n    }))\n  }];\n\n  const renderTitleBar = totalItems => {\n    return /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      alignItems: \"center\",\n      gutterSize: \"s\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 10\n    }, /*#__PURE__*/React.createElement(PanelTitle, {\n      title: \"Latency by trace group\",\n      totalItems: totalItems\n    })), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiLink, {\n      onClick: () => props.addPercentileFilter('lte')\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\"\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        color: '#957ac9'\n      }\n    }, \"\\u25A1\"), \" < 95 percentile\"))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 1\n    }), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiLink, {\n      onClick: () => props.addPercentileFilter('gte')\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"xs\"\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        color: '#957ac9'\n      }\n    }, \"\\u25A0\"), \" >= 95 percentile\"))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 1\n    }));\n  };\n\n  const varianceProps = useMemo(() => getVarianceProps(props.items), [props.items]);\n  const columns = useMemo(() => getColumns(), [props.items]);\n  const titleBar = useMemo(() => {\n    var _props$items;\n\n    return renderTitleBar((_props$items = props.items) === null || _props$items === void 0 ? void 0 : _props$items.length);\n  }, [props.items]);\n  const [sorting, setSorting] = useState({\n    sort: {\n      field: 'dashboard_latency_variance',\n      direction: 'desc'\n    }\n  });\n\n  const onTableChange = async ({\n    page,\n    sort\n  }) => {\n    if (typeof (sort === null || sort === void 0 ? void 0 : sort.field) !== 'string') return;\n    setSorting({\n      sort\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, titleBar, /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"none\"\n  }), ((_props$items2 = props.items) === null || _props$items2 === void 0 ? void 0 : _props$items2.length) > 0 ? /*#__PURE__*/React.createElement(EuiInMemoryTable, {\n    tableLayout: \"auto\",\n    items: props.items,\n    columns: columns,\n    pagination: {\n      initialPageSize: 10,\n      pageSizeOptions: [5, 10, 15]\n    },\n    sorting: sorting,\n    onTableChange: onTableChange\n  }) : /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"xl\"\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport { Dashboard } from './dashboard';","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButtonIcon, EuiFlexGroup, EuiFlexItem, EuiPopover, EuiText } from '@elastic/eui';\nimport React, { useState } from 'react';\nimport { LatencyPlt, LinePlt } from '../common/plots/latency_trend_plt';\nexport function LatencyTrendCell({\n  item,\n  traceGroupName\n}) {\n  const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n  return /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"s\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, null), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(LinePlt, {\n    data: item.trendData\n  })), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiPopover, {\n    ownFocus: true,\n    anchorPosition: \"downCenter\",\n    button: /*#__PURE__*/React.createElement(EuiButtonIcon, {\n      \"aria-label\": \"Open popover\",\n      onClick: () => setIsPopoverOpen(true),\n      iconType: \"magnifyWithPlus\",\n      size: \"s\"\n    }),\n    isOpen: isPopoverOpen,\n    closePopover: () => setIsPopoverOpen(false)\n  }, /*#__PURE__*/React.createElement(EuiFlexGroup, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\"\n  }, \"24-hour latency trend\"), /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\"\n  }, traceGroupName)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiButtonIcon, {\n    \"aria-label\": \"Close popover\",\n    iconType: \"cross\",\n    color: \"text\",\n    onClick: () => setIsPopoverOpen(false)\n  }))), /*#__PURE__*/React.createElement(LatencyPlt, {\n    data: item.popoverData\n  }))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport { Services } from './services';\nexport { ServiceView } from './service_view';\nexport { ServiceMap } from '../common/plots/service_map';","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiI18nNumber, EuiPage, EuiPageBody, EuiPanel, EuiSpacer, EuiText, EuiTitle } from '@elastic/eui';\nimport _ from 'lodash';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { handleServiceMapRequest, handleServiceViewRequest } from '../../requests/services_request_handler';\nimport { filtersToDsl, PanelTitle, renderDatePicker } from '../common';\nimport { ServiceMap } from '../common/plots/service_map';\nexport function ServiceView(props) {\n  const [fields, setFields] = useState({});\n  const [serviceMap, setServiceMap] = useState({});\n  const [serviceMapIdSelected, setServiceMapIdSelected] = useState('latency');\n  const [redirect, setRedirect] = useState(false);\n  useEffect(() => {\n    props.setBreadcrumbs([{\n      text: 'Trace Analytics',\n      href: '#'\n    }, {\n      text: 'Services',\n      href: '#/services'\n    }, {\n      text: props.serviceName,\n      href: `#/services/${encodeURIComponent(props.serviceName)}`\n    }]);\n  }, []);\n  useEffect(() => {\n    if (!redirect) refresh();\n  }, [props.startTime, props.endTime]);\n\n  const refresh = () => {\n    const DSL = filtersToDsl([], '', props.startTime, props.endTime);\n    handleServiceViewRequest(props.serviceName, props.http, DSL, fields, setFields);\n    handleServiceMapRequest(props.http, DSL, serviceMap, setServiceMap, props.serviceName);\n  };\n\n  const renderTitle = (serviceName, startTime, setStartTime, endTime, setEndTime, addFilter) => {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiTitle, {\n      size: \"l\"\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"overview-content\"\n    }, serviceName))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, renderDatePicker(startTime, setStartTime, endTime, setEndTime)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }));\n  };\n\n  const renderOverview = () => {\n    return /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(PanelTitle, {\n      title: \"Overview\"\n    }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n      margin: \"m\"\n    }), /*#__PURE__*/React.createElement(EuiFlexGroup, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      direction: \"column\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Name\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, props.serviceName || '-')), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Number of connected services\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.number_of_connected_services !== undefined ? fields.number_of_connected_services : 0)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Connected services\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.connected_services || '-')))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      direction: \"column\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Average latency (ms)\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.average_latency !== undefined ? fields.average_latency : '-')), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Error rate\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.error_rate !== undefined ? _.round(fields.error_rate, 2).toString() + '%' : '-')), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Throughput\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.throughput !== undefined ? /*#__PURE__*/React.createElement(EuiI18nNumber, {\n      value: fields.throughput\n    }) : '-')), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      className: \"overview-title\"\n    }, \"Traces\"), /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\",\n      className: \"overview-content\"\n    }, fields.traces !== undefined ? /*#__PURE__*/React.createElement(EuiI18nNumber, {\n      value: fields.traces\n    }) : '-'))))), /*#__PURE__*/React.createElement(EuiSpacer, null));\n  };\n\n  const overview = useMemo(() => renderOverview(), [fields, props.serviceName]);\n  const title = useMemo(() => renderTitle(props.serviceName, props.startTime, props.setStartTime, props.endTime, props.setEndTime, props.addFilter), [props.serviceName, props.startTime, props.endTime]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPage, null, /*#__PURE__*/React.createElement(EuiPageBody, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    alignItems: \"center\",\n    gutterSize: \"s\"\n  }, title), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"xl\"\n  }), overview, /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(ServiceMap, {\n    serviceMap: serviceMap,\n    idSelected: serviceMapIdSelected,\n    setIdSelected: setServiceMapIdSelected,\n    currService: props.serviceName\n  }))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiSpacer, EuiTitle } from '@elastic/eui';\nimport React, { useEffect, useState } from 'react';\nimport { handleServicesRequest } from '../../requests/services_request_handler';\nimport { filtersToDsl, MissingConfigurationMessage, SearchBar } from '../common';\nimport { getValidFilterFields } from '../common/filters/filter_helpers';\nimport { ServiceMap } from '../common/plots/service_map';\nimport { ServicesTable } from './services_table';\nexport function Services(props) {\n  const [serviceMap, setServiceMap] = useState({});\n  const [serviceMapIdSelected, setServiceMapIdSelected] = useState('latency');\n  const [tableItems, setTableItems] = useState([]);\n  const [redirect, setRedirect] = useState(true);\n  useEffect(() => {\n    props.setBreadcrumbs([{\n      text: 'Trace Analytics',\n      href: '#'\n    }, {\n      text: 'Services',\n      href: '#/services'\n    }]);\n    const validFilters = getValidFilterFields('services');\n    props.setFilters([...props.filters.map(filter => ({ ...filter,\n      locked: validFilters.indexOf(filter.field) === -1\n    }))]);\n    setRedirect(false);\n  }, []);\n  useEffect(() => {\n    if (!redirect && props.indicesExist) refresh();\n  }, [props.filters]);\n\n  const refresh = () => {\n    const DSL = filtersToDsl(props.filters, props.query, props.startTime, props.endTime);\n    handleServicesRequest(props.http, DSL, tableItems, setTableItems, setServiceMap, serviceQuery);\n  };\n\n  const addFilter = filter => {\n    for (const addedFilter of props.filters) {\n      if (addedFilter.field === filter.field && addedFilter.operator === filter.operator && addedFilter.value === filter.value) {\n        return;\n      }\n    }\n\n    const newFilters = [...props.filters, filter];\n    props.setFilters(newFilters);\n  };\n\n  const [serviceQuery, setServiceQuery] = useState('');\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiTitle, {\n    size: \"l\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      fontWeight: 430\n    }\n  }, \"Services\")), /*#__PURE__*/React.createElement(SearchBar, {\n    datepickerOnly: true,\n    query: props.query,\n    filters: props.filters,\n    setFilters: props.setFilters,\n    setQuery: props.setQuery,\n    startTime: props.startTime,\n    setStartTime: props.setStartTime,\n    endTime: props.endTime,\n    setEndTime: props.setEndTime,\n    refresh: refresh,\n    page: \"services\"\n  }), /*#__PURE__*/React.createElement(EuiSpacer, null), props.indicesExist ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ServicesTable, {\n    items: tableItems,\n    addFilter: addFilter,\n    setRedirect: setRedirect,\n    serviceQuery: serviceQuery,\n    setServiceQuery: setServiceQuery,\n    refresh: refresh\n  }), /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(ServiceMap, {\n    serviceMap: serviceMap,\n    idSelected: serviceMapIdSelected,\n    setIdSelected: setServiceMapIdSelected\n  })) : /*#__PURE__*/React.createElement(MissingConfigurationMessage, null));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFieldSearch, EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiI18nNumber, EuiInMemoryTable, EuiLink, EuiPanel, EuiText } from '@elastic/eui';\nimport _ from 'lodash';\nimport React, { useMemo } from 'react';\nimport { NoMatchMessage, PanelTitle } from '../common';\nexport function ServicesTable(props) {\n  var _props$items2;\n\n  const renderTitleBar = totalItems => {\n    return /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      alignItems: \"center\",\n      gutterSize: \"s\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 10\n    }, /*#__PURE__*/React.createElement(PanelTitle, {\n      title: \"Services\",\n      totalItems: totalItems\n    })));\n  };\n\n  const columns = useMemo(() => [{\n    field: 'name',\n    name: 'Name',\n    align: 'left',\n    sortable: true,\n    render: item => /*#__PURE__*/React.createElement(EuiLink, {\n      href: `#/services/${encodeURIComponent(item)}`\n    }, _.truncate(item, {\n      length: 24\n    }))\n  }, {\n    field: 'average_latency',\n    name: 'Average latency (ms)',\n    align: 'right',\n    sortable: true,\n    render: item => item === 0 || item ? _.round(item, 2) : '-'\n  }, {\n    field: 'error_rate',\n    name: 'Error rate',\n    align: 'right',\n    sortable: true,\n    render: item => item === 0 || item ? /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, `${_.round(item, 2)}%`) : '-'\n  }, {\n    field: 'throughput',\n    name: 'Throughput',\n    align: 'right',\n    sortable: true,\n    truncateText: true,\n    render: item => item === 0 || item ? /*#__PURE__*/React.createElement(EuiI18nNumber, {\n      value: item\n    }) : '-'\n  }, {\n    field: 'number_of_connected_services',\n    name: 'No. of connected services',\n    align: 'right',\n    sortable: true,\n    truncateText: true,\n    width: '80px',\n    render: item => item === 0 || item ? item : '-'\n  }, {\n    field: 'connected_services',\n    name: 'Connected services',\n    align: 'left',\n    sortable: true,\n    truncateText: true,\n    render: item => item ? /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, _.truncate(item, {\n      length: 50\n    })) : '-'\n  }, {\n    field: 'traces',\n    name: 'Traces',\n    align: 'right',\n    sortable: true,\n    truncateText: true,\n    render: item => item === 0 || item ? /*#__PURE__*/React.createElement(EuiI18nNumber, {\n      value: item\n    }) : '-'\n  }], [props.items]);\n  const titleBar = useMemo(() => {\n    var _props$items;\n\n    return renderTitleBar((_props$items = props.items) === null || _props$items === void 0 ? void 0 : _props$items.length);\n  }, [props.items]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, titleBar, /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"s\",\n    style: {\n      marginTop: 10\n    }\n  }), /*#__PURE__*/React.createElement(EuiFieldSearch, {\n    fullWidth: true,\n    placeholder: \"Service name\",\n    value: props.serviceQuery,\n    onChange: e => props.setServiceQuery(e.target.value),\n    onSearch: () => props.refresh()\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"s\",\n    style: {\n      marginBottom: 0\n    }\n  }), ((_props$items2 = props.items) === null || _props$items2 === void 0 ? void 0 : _props$items2.length) > 0 ? /*#__PURE__*/React.createElement(EuiInMemoryTable, {\n    tableLayout: \"auto\",\n    items: props.items,\n    columns: columns,\n    pagination: {\n      initialPageSize: 10,\n      pageSizeOptions: [5, 10, 15]\n    },\n    sorting: {\n      sort: {\n        field: 'name',\n        direction: 'asc'\n      }\n    }\n  }) : /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"xl\"\n  })));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport { Traces } from './traces';\nexport { TraceView } from './trace_view';","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiFlexGroup, EuiFlexItem, EuiHealth, EuiHorizontalRule, EuiPanel, EuiSpacer, EuiText } from '@elastic/eui';\nimport _ from 'lodash';\nimport React, { useMemo } from 'react';\nimport { PanelTitle } from '../common';\nimport { Plt } from '../common/plots/plt';\nexport function ServiceBreakdownPanel(props) {\n  var _props$data;\n\n  const layout = useMemo(() => ({\n    height: 200,\n    width: 200,\n    showlegend: false,\n    margin: {\n      l: 5,\n      r: 5,\n      b: 5,\n      t: 5\n    }\n  }), [props.data]);\n\n  const renderStats = () => {\n    return props.data.length > 0 ? /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      responsive: false,\n      style: {\n        maxHeight: 260,\n        overflowY: 'auto'\n      }\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      direction: \"column\",\n      alignItems: \"flexStart\",\n      gutterSize: \"m\",\n      responsive: false\n    }, props.data[0].marker.colors.map((color, i) => /*#__PURE__*/React.createElement(EuiFlexItem, {\n      key: `label-${i}`\n    }, /*#__PURE__*/React.createElement(EuiHealth, {\n      color: color\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        whiteSpace: 'nowrap'\n      }\n    }, props.data[0].labels[i])))))), /*#__PURE__*/React.createElement(EuiFlexItem, null), /*#__PURE__*/React.createElement(EuiFlexItem, null), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      direction: \"column\",\n      alignItems: \"flexEnd\",\n      gutterSize: \"m\",\n      responsive: false\n    }, props.data[0].values.map((value, i) => /*#__PURE__*/React.createElement(EuiFlexItem, {\n      key: `value-${i}`\n    }, /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, _.round(value, 2), \"%\")))))) : null;\n  };\n\n  const stats = useMemo(() => renderStats(), [props.data]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Time spent by service\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    direction: \"column\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, null, ((_props$data = props.data) === null || _props$data === void 0 ? void 0 : _props$data.length) > 0 ? /*#__PURE__*/React.createElement(Plt, {\n    data: props.data,\n    layout: layout\n  }) : null), /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(EuiFlexItem, null, stats)), /*#__PURE__*/React.createElement(EuiSpacer, null)));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiHorizontalRule, EuiPanel } from '@elastic/eui';\nimport React, { useMemo } from 'react';\nimport { PanelTitle } from '../common';\nimport { Plt } from '../common/plots/plt';\nexport function SpanDetailPanel(props) {\n  const getSpanDetailLayout = (plotTraces, maxX) => {\n    // get unique labels from traces\n    const yLabels = plotTraces.map(d => d.y[0]).filter((label, i, self) => self.indexOf(label) === i); // remove uuid when displaying y-ticks\n\n    const yTexts = yLabels.map(label => label.substring(0, label.length - 36));\n    return {\n      height: 25 * plotTraces.length + 60,\n      width: 800,\n      margin: {\n        l: 260,\n        r: 5,\n        b: 30,\n        t: 30\n      },\n      xaxis: {\n        ticksuffix: ' ms',\n        side: 'top',\n        color: '#91989c',\n        showline: true,\n        range: [0, maxX * 1.2]\n      },\n      yaxis: {\n        showgrid: false,\n        tickvals: yLabels,\n        ticktext: yTexts\n      }\n    };\n  };\n\n  const layout = useMemo(() => getSpanDetailLayout(props.data.gantt, props.data.ganttMaxX), [props.data.gantt, props.data.ganttMaxX]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Span detail\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      overflowY: 'auto',\n      maxHeight: 500\n    }\n  }, /*#__PURE__*/React.createElement(Plt, {\n    data: props.data.gantt,\n    layout: layout\n  }))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButtonIcon, EuiCodeBlock, EuiCopy, EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiPage, EuiPageBody, EuiPanel, EuiSpacer, EuiText, EuiTitle } from '@elastic/eui';\nimport React, { useEffect, useState } from 'react';\nimport { handlePayloadRequest, handleTracesChartsRequest, handleTraceViewRequest } from '../../requests/traces_request_handler';\nimport { PanelTitle } from '../common';\nimport { ServiceBreakdownPanel } from './service_breakdown_panel';\nimport { SpanDetailPanel } from './span_detail_panel';\n\nconst renderTitle = traceId => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiTitle, {\n    size: \"l\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"overview-content\"\n  }, traceId))));\n};\n\nconst renderOverview = fields => {\n  return /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Overview\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiFlexGroup, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    direction: \"column\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    className: \"overview-title\"\n  }, \"Trace ID\"), fields.trace_id && /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    gutterSize: \"s\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    className: \"overview-content\"\n  }, fields.trace_id)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiCopy, {\n    textToCopy: fields.trace_id\n  }, copy => /*#__PURE__*/React.createElement(EuiButtonIcon, {\n    \"aria-label\": \"Copy trace id\",\n    iconType: \"copyClipboard\",\n    onClick: copy\n  }, \"Click to copy\"))))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    className: \"overview-title\"\n  }, \"Trace group name\"), /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    className: \"overview-content\"\n  }, fields.trace_group)))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    direction: \"column\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    className: \"overview-title\"\n  }, \"Latency\"), /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    className: \"overview-content\"\n  }, fields.latency)), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    className: \"overview-title\"\n  }, \"Last updated\"), /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    className: \"overview-content\"\n  }, fields.last_updated)))), /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    direction: \"column\"\n  }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: false\n  }, /*#__PURE__*/React.createElement(EuiText, {\n    className: \"overview-title\"\n  }, \"Errors\"), /*#__PURE__*/React.createElement(EuiText, {\n    size: \"s\",\n    className: \"overview-content\"\n  }, fields.error_count))))));\n};\n\nexport function TraceView(props) {\n  const [fields, setFields] = useState({});\n  const [serviceBreakdownData, setServiceBreakdownData] = useState([]);\n  const [spanDetailData, setSpanDetailData] = useState({\n    gantt: [],\n    table: [],\n    ganttMaxX: 0\n  });\n  const [payloadData, setPayloadData] = useState('');\n  useEffect(() => {\n    props.setBreadcrumbs([{\n      text: 'Trace Analytics',\n      href: '#'\n    }, {\n      text: 'Traces',\n      href: '#/traces'\n    }, {\n      text: props.traceId,\n      href: `#/traces/${encodeURIComponent(props.traceId)}`\n    }]);\n    refresh();\n  }, []);\n\n  const refresh = () => {\n    handleTraceViewRequest(props.traceId, props.http, fields, setFields);\n    handleTracesChartsRequest(props.traceId, props.http, serviceBreakdownData, setServiceBreakdownData, spanDetailData, setSpanDetailData);\n    handlePayloadRequest(props.traceId, props.http, payloadData, setPayloadData);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPage, null, /*#__PURE__*/React.createElement(EuiPageBody, null, /*#__PURE__*/React.createElement(EuiFlexGroup, {\n    alignItems: \"center\",\n    gutterSize: \"s\"\n  }, renderTitle(props.traceId)), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"xl\"\n  }), renderOverview(fields), /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(EuiFlexGroup, null, /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: 3\n  }, /*#__PURE__*/React.createElement(ServiceBreakdownPanel, {\n    data: serviceBreakdownData\n  })), /*#__PURE__*/React.createElement(EuiFlexItem, {\n    grow: 7\n  }, /*#__PURE__*/React.createElement(SpanDetailPanel, {\n    data: spanDetailData\n  }))), /*#__PURE__*/React.createElement(EuiSpacer, null), /*#__PURE__*/React.createElement(EuiPanel, null, /*#__PURE__*/React.createElement(EuiFlexGroup, null, /*#__PURE__*/React.createElement(EuiFlexItem, null, /*#__PURE__*/React.createElement(PanelTitle, {\n    title: \"Payload\"\n  }))), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"m\"\n  }), payloadData.length > 0 ? /*#__PURE__*/React.createElement(EuiCodeBlock, {\n    language: \"json\",\n    paddingSize: \"s\",\n    isCopyable: true,\n    overflowHeight: 500\n  }, payloadData) : null))));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiSpacer, EuiTitle } from '@elastic/eui';\nimport React, { useEffect, useState } from 'react';\nimport { handleTracesRequest } from '../../requests/traces_request_handler';\nimport { filtersToDsl, SearchBar } from '../common';\nimport { getValidFilterFields } from '../common/filters/filter_helpers';\nimport { TracesTable } from './traces_table';\nexport function Traces(props) {\n  const [tableItems, setTableItems] = useState([]);\n  const [redirect, setRedirect] = useState(true);\n  useEffect(() => {\n    props.setBreadcrumbs([{\n      text: 'Trace Analytics',\n      href: '#'\n    }, {\n      text: 'Traces',\n      href: '#/traces'\n    }]);\n    const validFilters = getValidFilterFields('traces');\n    props.setFilters([...props.filters.map(filter => ({ ...filter,\n      locked: validFilters.indexOf(filter.field) === -1\n    }))]);\n    setRedirect(false);\n  }, []);\n  useEffect(() => {\n    if (!redirect && props.indicesExist) refresh();\n  }, [props.filters]);\n\n  const refresh = async sort => {\n    const DSL = filtersToDsl(props.filters, props.query, props.startTime, props.endTime);\n    const timeFilterDSL = filtersToDsl([], '', props.startTime, props.endTime);\n    await handleTracesRequest(props.http, DSL, timeFilterDSL, tableItems, setTableItems, sort);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiTitle, {\n    size: \"l\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      fontWeight: 430\n    }\n  }, \"Traces\")), /*#__PURE__*/React.createElement(SearchBar, {\n    query: props.query,\n    filters: props.filters,\n    setFilters: props.setFilters,\n    setQuery: props.setQuery,\n    startTime: props.startTime,\n    setStartTime: props.setStartTime,\n    endTime: props.endTime,\n    setEndTime: props.setEndTime,\n    refresh: refresh,\n    page: \"traces\"\n  }), /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), /*#__PURE__*/React.createElement(TracesTable, {\n    items: tableItems,\n    refresh: refresh,\n    indicesExist: props.indicesExist\n  }));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { EuiButtonIcon, EuiCopy, EuiFlexGroup, EuiFlexItem, EuiHorizontalRule, EuiInMemoryTable, EuiLink, EuiPanel, EuiSpacer, EuiText } from '@elastic/eui';\nimport _ from 'lodash';\nimport React, { useMemo, useState } from 'react';\nimport { TRACES_MAX_NUM } from '../../../common';\nimport { MissingConfigurationMessage, NoMatchMessage, PanelTitle } from '../common';\nexport function TracesTable(props) {\n  var _props$items3;\n\n  const renderTitleBar = totalItems => {\n    return /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      alignItems: \"center\",\n      gutterSize: \"s\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 10\n    }, /*#__PURE__*/React.createElement(PanelTitle, {\n      title: \"Traces\",\n      totalItems: totalItems\n    })));\n  };\n\n  const columns = useMemo(() => [{\n    field: 'trace_id',\n    name: 'Trace ID',\n    align: 'left',\n    sortable: true,\n    truncateText: true,\n    render: item => /*#__PURE__*/React.createElement(EuiFlexGroup, {\n      gutterSize: \"s\",\n      alignItems: \"center\"\n    }, /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 10\n    }, /*#__PURE__*/React.createElement(EuiLink, {\n      href: `#/traces/${encodeURIComponent(item)}`\n    }, _.truncate(item, {\n      length: 24\n    }))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: false\n    }, /*#__PURE__*/React.createElement(EuiCopy, {\n      textToCopy: item\n    }, copy => /*#__PURE__*/React.createElement(EuiButtonIcon, {\n      \"aria-label\": \"Copy trace id\",\n      iconType: \"copyClipboard\",\n      onClick: copy\n    }, \"Click to copy\"))), /*#__PURE__*/React.createElement(EuiFlexItem, {\n      grow: 3\n    }))\n  }, {\n    field: 'trace_group',\n    name: 'Trace group',\n    align: 'left',\n    sortable: true,\n    truncateText: true,\n    render: item => /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, _.truncate(item, {\n      length: 24\n    }))\n  }, {\n    field: 'latency',\n    name: 'Latency (ms)',\n    align: 'right',\n    sortable: true,\n    truncateText: true\n  }, {\n    field: 'percentile_in_trace_group',\n    name: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, \"Percentile in trace group\")),\n    align: 'right',\n    sortable: true,\n    render: item => item === 0 || item ? /*#__PURE__*/React.createElement(EuiText, {\n      size: \"s\"\n    }, `${_.round(item, 2)}th`) : '-'\n  }, {\n    field: 'error_count',\n    name: 'Errors',\n    align: 'right',\n    sortable: true,\n    render: item => item === 0 || item ? item : '-'\n  }, {\n    field: 'last_updated',\n    name: 'Last updated',\n    align: 'left',\n    sortable: true,\n    render: item => item === 0 || item ? item : '-'\n  }], [props.items]);\n  const titleBar = useMemo(() => {\n    var _props$items;\n\n    return renderTitleBar((_props$items = props.items) === null || _props$items === void 0 ? void 0 : _props$items.length);\n  }, [props.items]);\n  const [sorting, setSorting] = useState({\n    sort: {\n      field: 'trace_id',\n      direction: 'asc'\n    }\n  });\n\n  const onTableChange = async ({\n    page,\n    sort\n  }) => {\n    var _props$items2;\n\n    if (typeof (sort === null || sort === void 0 ? void 0 : sort.field) !== 'string') return;\n    const field = {\n      trace_id: '_key',\n      trace_group: null,\n      latency: 'latency',\n      percentile_in_trace_group: null,\n      error_count: 'error_count',\n      last_updated: 'last_updated'\n    }[sort.field];\n\n    if (!field || ((_props$items2 = props.items) === null || _props$items2 === void 0 ? void 0 : _props$items2.length) < TRACES_MAX_NUM) {\n      setSorting({\n        sort\n      });\n      return;\n    } // using await when sorting the default sorted field leads to a bug in UI\n\n\n    if (sort.field === 'trace_id') {\n      props.refresh({ ...sort,\n        field\n      });\n      setSorting({\n        sort\n      });\n      return;\n    }\n\n    await props.refresh({ ...sort,\n      field\n    });\n    setSorting({\n      sort\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EuiPanel, null, titleBar, /*#__PURE__*/React.createElement(EuiSpacer, {\n    size: \"m\"\n  }), /*#__PURE__*/React.createElement(EuiHorizontalRule, {\n    margin: \"none\"\n  }), ((_props$items3 = props.items) === null || _props$items3 === void 0 ? void 0 : _props$items3.length) > 0 ? /*#__PURE__*/React.createElement(EuiInMemoryTable, {\n    tableLayout: \"auto\",\n    items: props.items,\n    columns: columns,\n    pagination: {\n      initialPageSize: 10,\n      pageSizeOptions: [5, 10, 15]\n    },\n    sorting: sorting,\n    onTableChange: onTableChange\n  }) : props.indicesExist ? /*#__PURE__*/React.createElement(NoMatchMessage, {\n    size: \"xl\"\n  }) : /*#__PURE__*/React.createElement(MissingConfigurationMessage, null)));\n}","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { DATE_PICKER_FORMAT } from '../../common';\nimport { fixedIntervalToMilli, nanoToMilliSec } from '../components/common/helper_functions';\nimport { getDashboardQuery, getDashboardThroughputPltQuery, getDashboardTraceGroupPercentiles, getErrorRatePltQuery } from './queries/dashboard_queries';\nimport { handleDslRequest } from './request_handler';\nexport const handleDashboardRequest = async (http, DSL, timeFilterDSL, items, setItems, setPercentileMap) => {\n  // latency_variance should only be affected by timefilter\n  const latencyVariances = await handleDslRequest(http, timeFilterDSL, getDashboardTraceGroupPercentiles()).then(response => {\n    const map = {};\n    response.aggregations.trace_group.buckets.forEach(traceGroup => {\n      map[traceGroup.key] = Object.values(traceGroup.latency_variance_nanos.values).map(nano => _.round(nanoToMilliSec(Math.max(0, nano)), 2));\n    });\n    return map;\n  }).catch(error => console.error(error));\n  if (setPercentileMap) setPercentileMap(latencyVariances);\n  handleDslRequest(http, DSL, getDashboardQuery()).then(response => {\n    return Promise.all(response.aggregations.trace_group_name.buckets.map(bucket => {\n      var _values$x;\n\n      const latencyTrend = bucket.group_by_hour.buckets.slice(-24).filter(bucket => {\n        var _bucket$average_laten, _bucket$average_laten2;\n\n        return ((_bucket$average_laten = bucket.average_latency) === null || _bucket$average_laten === void 0 ? void 0 : _bucket$average_laten.value) || ((_bucket$average_laten2 = bucket.average_latency) === null || _bucket$average_laten2 === void 0 ? void 0 : _bucket$average_laten2.value) === 0;\n      });\n      const values = {\n        x: latencyTrend.map(bucket => bucket.key),\n        y: latencyTrend.map(bucket => {\n          var _bucket$average_laten3;\n\n          return ((_bucket$average_laten3 = bucket.average_latency) === null || _bucket$average_laten3 === void 0 ? void 0 : _bucket$average_laten3.value) || 0;\n        })\n      };\n      const latencyTrendData = ((_values$x = values.x) === null || _values$x === void 0 ? void 0 : _values$x.length) > 0 ? {\n        '24_hour_latency_trend': {\n          trendData: [{ ...values,\n            type: 'scatter',\n            mode: 'lines',\n            hoverinfo: 'none',\n            line: {\n              color: '#000000',\n              width: 1\n            }\n          }],\n          popoverData: [{ ...values,\n            type: 'scatter',\n            mode: 'lines+markers',\n            hovertemplate: '%{x}<br>Average latency: %{y}<extra></extra>',\n            hoverlabel: {\n              bgcolor: '#d7c2ff'\n            },\n            marker: {\n              color: '#987dcb',\n              size: 8\n            },\n            line: {\n              color: '#987dcb',\n              size: 2\n            }\n          }]\n        }\n      } : {};\n      return {\n        dashboard_trace_group_name: bucket.key,\n        dashboard_average_latency: bucket.average_latency.value,\n        dashboard_traces: bucket.doc_count,\n        dashboard_latency_variance: latencyVariances[bucket.key],\n        dashboard_error_rate: bucket.error_rate.value,\n        ...latencyTrendData\n      };\n    }));\n  }).then(newItems => {\n    setItems(newItems);\n  }).catch(error => console.error(error));\n};\nexport const handleDashboardThroughputPltRequest = (http, DSL, fixedInterval, items, setItems) => {\n  handleDslRequest(http, DSL, getDashboardThroughputPltQuery(fixedInterval)).then(response => {\n    const buckets = response.aggregations.throughput.buckets;\n    const texts = buckets.map(bucket => `${moment(bucket.key).format(DATE_PICKER_FORMAT)} - ${moment(bucket.key + fixedIntervalToMilli(fixedInterval)).format(DATE_PICKER_FORMAT)}`);\n    const newItems = buckets.length > 0 ? [{\n      x: buckets.map(bucket => bucket.key),\n      y: buckets.map(bucket => bucket.doc_count),\n      marker: {\n        color: 'rgb(171, 211, 240)'\n      },\n      type: 'bar',\n      text: texts,\n      hoverlabel: {\n        align: 'left'\n      },\n      hovertemplate: '%{text}<br>Throughput: %{y:,}<extra></extra>'\n    }] : [];\n    setItems({\n      items: newItems,\n      fixedInterval: fixedInterval\n    });\n  }).catch(error => console.error(error));\n};\nexport const handleDashboardErrorRatePltRequest = (http, DSL, fixedInterval, items, setItems) => {\n  handleDslRequest(http, DSL, getErrorRatePltQuery(fixedInterval)).then(response => {\n    const buckets = response.aggregations.error_rate.buckets;\n    const texts = buckets.map(bucket => `${moment(bucket.key).format(DATE_PICKER_FORMAT)} - ${moment(bucket.key + fixedIntervalToMilli(fixedInterval)).format(DATE_PICKER_FORMAT)}`);\n    const newItems = buckets.length > 0 ? [{\n      x: buckets.map(bucket => bucket.key),\n      y: buckets.map(bucket => {\n        var _bucket$error_rate;\n\n        return _.round(((_bucket$error_rate = bucket.error_rate) === null || _bucket$error_rate === void 0 ? void 0 : _bucket$error_rate.value) || 0, 2);\n      }),\n      marker: {\n        color: '#fad963'\n      },\n      type: 'bar',\n      text: texts,\n      hoverlabel: {\n        align: 'left'\n      },\n      hovertemplate: '%{text}<br>Error rate: %{y}<extra></extra>'\n    }] : [];\n    setItems({\n      items: newItems,\n      fixedInterval: fixedInterval\n    });\n  }).catch(error => console.error(error));\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport const getDashboardQuery = () => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      trace_group_name: {\n        terms: {\n          field: 'traceGroup',\n          size: 10000\n        },\n        aggs: {\n          group_by_hour: {\n            date_histogram: {\n              field: 'endTime',\n              calendar_interval: 'hour'\n            },\n            aggs: {\n              average_latency_nanos: {\n                avg: {\n                  field: 'durationInNanos'\n                }\n              },\n              average_latency: {\n                bucket_script: {\n                  buckets_path: {\n                    count: '_count',\n                    latency: 'average_latency_nanos.value'\n                  },\n                  script: 'Math.round(params.latency / 10000) / 100.0'\n                }\n              }\n            }\n          },\n          average_latency_nanos: {\n            avg: {\n              field: 'durationInNanos'\n            }\n          },\n          average_latency: {\n            bucket_script: {\n              buckets_path: {\n                count: '_count',\n                latency: 'average_latency_nanos.value'\n              },\n              script: 'Math.round(params.latency / 10000) / 100.0'\n            }\n          },\n          error_count: {\n            filter: {\n              term: {\n                'status.code': '2'\n              }\n            }\n          },\n          error_rate: {\n            bucket_script: {\n              buckets_path: {\n                total: '_count',\n                errors: 'error_count._count'\n              },\n              script: 'params.errors / params.total * 100'\n            }\n          }\n        }\n      }\n    }\n  };\n  return query;\n};\nexport const getDashboardTraceGroupPercentiles = () => {\n  return {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      trace_group: {\n        terms: {\n          field: 'traceGroup'\n        },\n        aggs: {\n          latency_variance_nanos: {\n            percentiles: {\n              field: 'durationInNanos',\n              percents: [0, 95, 100]\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport const getErrorRatePltQuery = fixedInterval => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [{\n          exists: {\n            field: 'traceGroup'\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      error_rate: {\n        date_histogram: {\n          field: 'startTime',\n          fixed_interval: fixedInterval\n        },\n        aggs: {\n          error_count: {\n            filter: {\n              term: {\n                'status.code': '2'\n              }\n            }\n          },\n          error_rate: {\n            bucket_script: {\n              buckets_path: {\n                total: '_count',\n                errors: 'error_count._count'\n              },\n              script: 'params.errors / params.total * 100'\n            }\n          }\n        }\n      }\n    }\n  };\n  return query;\n};\nexport const getDashboardThroughputPltQuery = fixedInterval => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [{\n          exists: {\n            field: 'traceGroup'\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      throughput: {\n        date_histogram: {\n          field: 'startTime',\n          fixed_interval: fixedInterval\n        }\n      }\n    }\n  };\n  return query;\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { SERVICE_MAP_INDEX_NAME, SERVICE_MAP_MAX_EDGES, SERVICE_MAP_MAX_NODES } from '../../../common';\nimport { getServiceMapTargetResources } from '../../components/common';\nexport const getServicesQuery = (serviceName = null, DSL) => {\n  var _DSL$custom, _DSL$custom$serviceNa, _DSL$custom2, _DSL$custom2$serviceN;\n\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      service: {\n        terms: {\n          field: 'serviceName'\n        },\n        aggs: {\n          trace_count: {\n            cardinality: {\n              field: 'traceId'\n            }\n          }\n        }\n      }\n    }\n  };\n\n  if (serviceName) {\n    query.query.bool.must.push({\n      term: {\n        serviceName: serviceName\n      }\n    });\n  }\n\n  DSL === null || DSL === void 0 ? void 0 : (_DSL$custom = DSL.custom) === null || _DSL$custom === void 0 ? void 0 : (_DSL$custom$serviceNa = _DSL$custom.serviceNames) === null || _DSL$custom$serviceNa === void 0 ? void 0 : _DSL$custom$serviceNa.map(service => {\n    query.query.bool.must.push({\n      term: {\n        serviceName: service\n      }\n    });\n  });\n  DSL === null || DSL === void 0 ? void 0 : (_DSL$custom2 = DSL.custom) === null || _DSL$custom2 === void 0 ? void 0 : (_DSL$custom2$serviceN = _DSL$custom2.serviceNamesExclude) === null || _DSL$custom2$serviceN === void 0 ? void 0 : _DSL$custom2$serviceN.map(service => {\n    query.query.bool.must_not.push({\n      term: {\n        serviceName: service\n      }\n    });\n  });\n  return query;\n};\nexport const getRelatedServicesQuery = serviceName => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      traces: {\n        terms: {\n          field: 'traceId',\n          size: 10000\n        },\n        aggs: {\n          all_services: {\n            terms: {\n              field: 'serviceName',\n              size: 10000\n            }\n          },\n          service: {\n            filter: {\n              bool: {\n                must: [{\n                  term: {\n                    serviceName: serviceName\n                  }\n                }],\n                must_not: []\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  return query;\n};\nexport const getServiceNodesQuery = () => {\n  return {\n    index: SERVICE_MAP_INDEX_NAME,\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      service_name: {\n        terms: {\n          field: 'serviceName',\n          size: SERVICE_MAP_MAX_NODES\n        },\n        aggs: {\n          trace_group: {\n            terms: {\n              field: 'traceGroupName',\n              size: SERVICE_MAP_MAX_EDGES\n            },\n            aggs: {\n              target_resource: {\n                terms: {\n                  field: 'target.resource',\n                  size: SERVICE_MAP_MAX_EDGES\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport const getServiceEdgesQuery = source => {\n  return {\n    index: SERVICE_MAP_INDEX_NAME,\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      service_name: {\n        terms: {\n          field: 'serviceName',\n          size: SERVICE_MAP_MAX_EDGES\n        },\n        aggs: {\n          resource: {\n            terms: {\n              field: `${source}.resource`,\n              size: SERVICE_MAP_MAX_EDGES\n            },\n            aggs: {\n              domain: {\n                terms: {\n                  field: `${source}.domain`,\n                  size: SERVICE_MAP_MAX_EDGES\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport const getServiceMetricsQuery = (DSL, serviceNames, map) => {\n  var _DSL$custom3, _DSL$custom4;\n\n  const traceGroupFilter = new Set((_DSL$custom3 = DSL.custom) === null || _DSL$custom3 === void 0 ? void 0 : _DSL$custom3.traceGroup);\n  const targetResource = traceGroupFilter.size > 0 ? [].concat(...[].concat(...serviceNames.map(service => map[service].traceGroups.filter(traceGroup => traceGroupFilter.has(traceGroup.traceGroup)).map(traceGroup => traceGroup.targetResource)))) : [].concat(...Object.keys(map).map(service => getServiceMapTargetResources(map, service)));\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        should: [],\n        must_not: [],\n        filter: [{\n          terms: {\n            serviceName: serviceNames\n          }\n        }, {\n          bool: {\n            should: [{\n              bool: {\n                filter: [{\n                  bool: {\n                    must_not: {\n                      exists: {\n                        field: 'traceGroup',\n                        boost: 1\n                      }\n                    }\n                  }\n                }, {\n                  terms: {\n                    name: targetResource\n                  }\n                }]\n              }\n            }, {\n              bool: {\n                must: {\n                  exists: {\n                    field: 'traceGroup',\n                    boost: 1\n                  }\n                }\n              }\n            }],\n            adjust_pure_negative: true,\n            boost: 1\n          }\n        }]\n      }\n    },\n    aggregations: {\n      service_name: {\n        terms: {\n          field: 'serviceName',\n          size: SERVICE_MAP_MAX_NODES,\n          min_doc_count: 1,\n          shard_min_doc_count: 0,\n          show_term_doc_count_error: false,\n          order: [{\n            _count: 'desc'\n          }, {\n            _key: 'asc'\n          }]\n        },\n        aggregations: {\n          average_latency_nanos: {\n            avg: {\n              field: 'durationInNanos'\n            }\n          },\n          average_latency: {\n            bucket_script: {\n              buckets_path: {\n                count: '_count',\n                latency: 'average_latency_nanos.value'\n              },\n              script: 'Math.round(params.latency / 10000) / 100.0'\n            }\n          },\n          error_count: {\n            filter: {\n              term: {\n                'status.code': '2'\n              }\n            }\n          },\n          error_rate: {\n            bucket_script: {\n              buckets_path: {\n                total: '_count',\n                errors: 'error_count._count'\n              },\n              script: 'params.errors / params.total * 100'\n            }\n          }\n        }\n      }\n    }\n  };\n  if (((_DSL$custom4 = DSL.custom) === null || _DSL$custom4 === void 0 ? void 0 : _DSL$custom4.timeFilter.length) > 0) query.query.bool.must.push(...DSL.custom.timeFilter);\n  return query;\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { TRACES_MAX_NUM } from '../../../common';\nexport const getTraceGroupPercentilesQuery = () => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [{\n          exists: {\n            field: 'traceGroup'\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      trace_group_name: {\n        terms: {\n          field: 'name',\n          size: 10000\n        },\n        aggs: {\n          percentiles: {\n            percentiles: {\n              field: 'durationInNanos',\n              percents: Array.from({\n                length: 101\n              }, (v, i) => i)\n            }\n          }\n        }\n      }\n    }\n  };\n  return query;\n};\nexport const getTracesQuery = (traceId = null, sort) => {\n  const field = (sort === null || sort === void 0 ? void 0 : sort.field) || '_key';\n  const direction = (sort === null || sort === void 0 ? void 0 : sort.direction) || 'asc';\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [{\n          exists: {\n            field: 'traceGroup'\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      traces: {\n        terms: {\n          field: 'traceId',\n          size: TRACES_MAX_NUM,\n          order: {\n            [field]: direction\n          }\n        },\n        aggs: {\n          latency: {\n            max: {\n              script: {\n                source: \"Math.round(doc['durationInNanos'].value / 10000) / 100.0\",\n                lang: 'painless'\n              }\n            }\n          },\n          trace_group: {\n            terms: {\n              field: 'name',\n              size: 1\n            }\n          },\n          error_count: {\n            filter: {\n              term: {\n                'status.code': '2'\n              }\n            }\n          },\n          last_updated: {\n            max: {\n              field: 'endTime'\n            }\n          }\n        }\n      }\n    }\n  };\n\n  if (traceId) {\n    query.query.bool.must.push({\n      term: {\n        traceId\n      }\n    });\n  }\n\n  return query;\n};\nexport const getServiceBreakdownQuery = traceId => {\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [{\n          term: {\n            traceId\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      service_type: {\n        terms: {\n          field: 'serviceName',\n          order: [{\n            total_latency_nanos: 'desc'\n          }]\n        },\n        aggs: {\n          total_latency_nanos: {\n            sum: {\n              field: 'durationInNanos'\n            }\n          },\n          total_latency: {\n            bucket_script: {\n              buckets_path: {\n                count: '_count',\n                latency: 'total_latency_nanos.value'\n              },\n              script: 'Math.round(params.latency / 10000) / 100.0'\n            }\n          }\n        }\n      }\n    }\n  };\n  return query;\n};\nexport const getSpanDetailQuery = (traceId, size = 200) => {\n  const query = {\n    size,\n    query: {\n      bool: {\n        must: [{\n          term: {\n            traceId\n          }\n        }, {\n          exists: {\n            field: 'serviceName'\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    sort: [{\n      startTime: {\n        order: 'desc'\n      }\n    }],\n    _source: {\n      includes: ['serviceName', 'name', 'startTime', 'endTime', 'spanId', 'status.code', 'durationInNanos']\n    }\n  };\n  return query;\n};\nexport const getPayloadQuery = (traceId, size = 1000) => {\n  return {\n    size,\n    query: {\n      bool: {\n        must: [{\n          term: {\n            traceId\n          }\n        }],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    }\n  };\n};\nexport const getValidTraceIdsQuery = DSL => {\n  var _DSL$custom, _DSL$custom2, _DSL$custom3, _DSL$custom3$percenti, _DSL$custom4;\n\n  const query = {\n    size: 0,\n    query: {\n      bool: {\n        must: [],\n        filter: [],\n        should: [],\n        must_not: []\n      }\n    },\n    aggs: {\n      traces: {\n        terms: {\n          field: 'traceId',\n          size: 10000\n        }\n      }\n    }\n  };\n  if (((_DSL$custom = DSL.custom) === null || _DSL$custom === void 0 ? void 0 : _DSL$custom.timeFilter.length) > 0) query.query.bool.must.push(...DSL.custom.timeFilter);\n\n  if (((_DSL$custom2 = DSL.custom) === null || _DSL$custom2 === void 0 ? void 0 : _DSL$custom2.traceGroup.length) > 0) {\n    query.query.bool.filter.push({\n      terms: {\n        traceGroup: DSL.custom.traceGroup\n      }\n    });\n  }\n\n  if (((_DSL$custom3 = DSL.custom) === null || _DSL$custom3 === void 0 ? void 0 : (_DSL$custom3$percenti = _DSL$custom3.percentiles) === null || _DSL$custom3$percenti === void 0 ? void 0 : _DSL$custom3$percenti.query.bool.should.length) > 0) {\n    query.query.bool.should.push(...DSL.custom.percentiles.query.bool.should);\n    query.query.bool.minimum_should_match = DSL.custom.percentiles.query.bool.minimum_should_match;\n  }\n\n  if (((_DSL$custom4 = DSL.custom) === null || _DSL$custom4 === void 0 ? void 0 : _DSL$custom4.serviceNames.length) > 0) {\n    query.query.bool.filter.push({\n      terms: {\n        serviceName: DSL.custom.serviceNames\n      }\n    });\n  }\n\n  return query;\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport { DSL_ROUTE, INDICES_ROUTE } from '../../server/utils/constants';\nexport function handleDslRequest(http, DSL, query) {\n  if (DSL !== null && DSL !== void 0 && DSL.query) {\n    query.query.bool.must.push(...DSL.query.bool.must);\n    query.query.bool.filter.push(...DSL.query.bool.filter);\n    query.query.bool.should.push(...DSL.query.bool.should);\n    query.query.bool.must_not.push(...DSL.query.bool.must_not);\n    if (DSL.query.bool.minimum_should_match) query.query.bool.minimum_should_match = DSL.query.bool.minimum_should_match;\n  }\n\n  return http.post(DSL_ROUTE, {\n    body: JSON.stringify(query)\n  }).catch(error => console.error(error));\n}\nexport async function handleIndicesExistRequest(http, setIndicesExist) {\n  http.post(INDICES_ROUTE).then(exists => setIndicesExist(exists)).catch(() => setIndicesExist(false));\n} // export function handleSqlRequest(http: CoreStart['http'], query: string) {\n//   console.log('SQL:', query);\n//   return http\n//     .post(SQL_ROUTE, {\n//       body: `{ \"query\": \"${query}\" }`,\n//     })\n//     .catch((error) => console.error(error));\n// }","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport _ from 'lodash';\nimport { getServiceEdgesQuery, getServiceMetricsQuery, getServiceNodesQuery, getServicesQuery } from './queries/services_queries';\nimport { handleDslRequest } from './request_handler';\nexport const handleServicesRequest = async (http, DSL, items, setItems, setServiceMap, serviceNameFilter) => {\n  handleDslRequest(http, DSL, getServicesQuery(serviceNameFilter, DSL)).then(async response => {\n    const serviceObject = await handleServiceMapRequest(http, {});\n    if (setServiceMap) setServiceMap(serviceObject);\n    return Promise.all(response.aggregations.service.buckets.map(bucket => {\n      const connectedServices = [...serviceObject[bucket.key].targetServices, ...serviceObject[bucket.key].destServices];\n      return {\n        name: bucket.key,\n        average_latency: serviceObject[bucket.key].latency,\n        error_rate: serviceObject[bucket.key].error_rate,\n        throughput: serviceObject[bucket.key].throughput,\n        traces: bucket.trace_count.value,\n        connected_services: connectedServices.join(', '),\n        number_of_connected_services: connectedServices.length\n      };\n    }));\n  }).then(newItems => {\n    setItems(newItems);\n  }).catch(error => console.error(error));\n};\nexport const handleServiceMapRequest = async (http, DSL, items, setItems, currService) => {\n  const map = {};\n  let id = 1;\n  await handleDslRequest(http, null, getServiceNodesQuery()).then(response => response.aggregations.service_name.buckets.map(bucket => map[bucket.key] = {\n    serviceName: bucket.key,\n    id: id++,\n    traceGroups: bucket.trace_group.buckets.map(traceGroup => ({\n      traceGroup: traceGroup.key,\n      targetResource: traceGroup.target_resource.buckets.map(res => res.key)\n    })),\n    targetServices: [],\n    destServices: []\n  })).catch(error => console.error(error));\n  const targets = {};\n  await handleDslRequest(http, null, getServiceEdgesQuery('target')).then(response => response.aggregations.service_name.buckets.map(bucket => {\n    bucket.resource.buckets.map(resource => {\n      resource.domain.buckets.map(domain => {\n        targets[resource.key + ':' + domain.key] = bucket.key;\n      });\n    });\n  })).catch(error => console.error(error));\n  await handleDslRequest(http, null, getServiceEdgesQuery('destination')).then(response => Promise.all(response.aggregations.service_name.buckets.map(bucket => {\n    bucket.resource.buckets.map(resource => {\n      resource.domain.buckets.map(domain => {\n        const targetService = targets[resource.key + ':' + domain.key];\n        if (map[bucket.key].targetServices.indexOf(targetService) === -1) map[bucket.key].targetServices.push(targetService);\n        if (map[targetService].destServices.indexOf(bucket.key) === -1) map[targetService].destServices.push(bucket.key);\n      });\n    });\n  }))).catch(error => console.error(error)); // service map handles DSL differently\n\n  const latencies = await handleDslRequest(http, {}, getServiceMetricsQuery(DSL, Object.keys(map), map));\n  latencies.aggregations.service_name.buckets.map(bucket => {\n    map[bucket.key].latency = bucket.average_latency.value;\n    map[bucket.key].error_rate = _.round(bucket.error_rate.value, 2) || 0;\n    map[bucket.key].throughput = bucket.doc_count;\n  });\n  if (setItems) setItems(map);\n  return map;\n};\nexport const handleServiceViewRequest = (serviceName, http, DSL, fields, setFields) => {\n  handleDslRequest(http, DSL, getServicesQuery(serviceName)).then(async response => {\n    const bucket = response.aggregations.service.buckets[0];\n    if (!bucket) return {};\n    const serviceObject = await handleServiceMapRequest(http, {});\n    const connectedServices = [...serviceObject[bucket.key].targetServices, ...serviceObject[bucket.key].destServices];\n    return {\n      name: bucket.key,\n      connected_services: connectedServices.join(', '),\n      number_of_connected_services: connectedServices.length,\n      average_latency: serviceObject[bucket.key].latency,\n      error_rate: serviceObject[bucket.key].error_rate,\n      throughput: serviceObject[bucket.key].throughput,\n      traces: bucket.trace_count.value\n    };\n  }).then(newFields => {\n    setFields(newFields);\n  }).catch(error => console.error(error));\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { v1 as uuid } from 'uuid';\nimport { DATE_FORMAT } from '../../common';\nimport { nanoToMilliSec } from '../components/common';\nimport { getPayloadQuery, getServiceBreakdownQuery, getSpanDetailQuery, getTraceGroupPercentilesQuery, getTracesQuery, getValidTraceIdsQuery } from './queries/traces_queries';\nimport { handleDslRequest } from './request_handler';\nexport const handleValidTraceIds = (http, DSL) => {\n  return handleDslRequest(http, {}, getValidTraceIdsQuery(DSL)).then(response => response.aggregations.traces.buckets.map(bucket => bucket.key)).catch(error => console.error(error));\n};\nexport const handleTracesRequest = async (http, DSL, timeFilterDSL, items, setItems, sort) => {\n  const binarySearch = (arr, target) => {\n    if (!arr) return Number.NaN;\n    let low = 0;\n    let high = arr.length;\n    let mid;\n\n    while (low < high) {\n      mid = Math.floor((low + high) / 2);\n      if (arr[mid] < target) low = mid + 1;else high = mid;\n    }\n\n    return low;\n  }; // percentile should only be affected by timefilter\n\n\n  const percentileRanges = await handleDslRequest(http, timeFilterDSL, getTraceGroupPercentilesQuery()).then(response => {\n    const map = {};\n    response.aggregations.trace_group_name.buckets.forEach(traceGroup => {\n      map[traceGroup.key] = Object.values(traceGroup.percentiles.values).map(value => nanoToMilliSec(value));\n    });\n    return map;\n  });\n  return handleDslRequest(http, DSL, getTracesQuery(undefined, sort)).then(response => {\n    return Promise.all(response.aggregations.traces.buckets.map(bucket => {\n      var _bucket$trace_group$b, _bucket$trace_group$b2;\n\n      return {\n        trace_id: bucket.key,\n        trace_group: (_bucket$trace_group$b = bucket.trace_group.buckets[0]) === null || _bucket$trace_group$b === void 0 ? void 0 : _bucket$trace_group$b.key,\n        latency: bucket.latency.value,\n        last_updated: moment(bucket.last_updated.value).format(DATE_FORMAT),\n        error_count: bucket.error_count.doc_count > 0 ? 'Yes' : 'No',\n        percentile_in_trace_group: binarySearch(percentileRanges[(_bucket$trace_group$b2 = bucket.trace_group.buckets[0]) === null || _bucket$trace_group$b2 === void 0 ? void 0 : _bucket$trace_group$b2.key], bucket.latency.value),\n        actions: '#'\n      };\n    }));\n  }).then(newItems => {\n    setItems(newItems);\n  }).catch(error => console.error(error));\n};\nexport const handleTraceViewRequest = (traceId, http, fields, setFields) => {\n  handleDslRequest(http, null, getTracesQuery(traceId)).then(async response => {\n    var _bucket$trace_group$b3;\n\n    const bucket = response.aggregations.traces.buckets[0];\n    return {\n      trace_id: bucket.key,\n      trace_group: (_bucket$trace_group$b3 = bucket.trace_group.buckets[0]) === null || _bucket$trace_group$b3 === void 0 ? void 0 : _bucket$trace_group$b3.key,\n      last_updated: moment(bucket.last_updated.value).format(DATE_FORMAT),\n      user_id: 'N/A',\n      latency: bucket.latency.value,\n      latency_vs_benchmark: 'N/A',\n      percentile_in_trace_group: 'N/A',\n      error_count: bucket.error_count.doc_count > 0 ? 'Yes' : 'No',\n      errors_vs_benchmark: 'N/A'\n    };\n  }).then(newFields => {\n    setFields(newFields);\n  }).catch(error => console.error(error));\n};\nexport const handleTracesChartsRequest = async (traceId, http, serviceBreakdownData, setServiceBreakdownData, spanDetailData, setSpanDetailData) => {\n  const colors = ['#7492e7', '#c33d69', '#2ea597', '#8456ce', '#e07941', '#3759ce', '#ce567c', '#9469d6', '#4066df', '#da7596', '#a783e1', '#5978e3'];\n  const colorMap = {};\n  let index = 0;\n  Promise.all([handleDslRequest(http, null, getServiceBreakdownQuery(traceId)).then(response => Promise.all(response.aggregations.service_type.buckets.map(bucket => {\n    colorMap[bucket.key] = colors[index++ % colors.length];\n    return {\n      name: bucket.key,\n      color: colorMap[bucket.key],\n      value: bucket.total_latency.value,\n      benchmark: 0\n    };\n  }))).then(newItems => {\n    const latencySum = newItems.map(item => item.value).reduce((a, b) => a + b, 0);\n    return [{\n      values: newItems.map(item => latencySum === 0 ? 100 : item.value / latencySum * 100),\n      labels: newItems.map(item => item.name),\n      benchmarks: newItems.map(item => item.benchmark),\n      marker: {\n        colors: newItems.map(item => item.color)\n      },\n      type: 'pie',\n      textinfo: 'none',\n      hovertemplate: '%{label}<br>%{value:.2f}%<extra></extra>'\n    }];\n  }).then(newItems => {\n    setServiceBreakdownData(newItems);\n  }).catch(error => console.error(error)), handleDslRequest(http, null, getSpanDetailQuery(traceId))]).then(response => hitsToSpanDetailData(response[1].hits.hits, colorMap)).then(newItems => setSpanDetailData(newItems)).catch(error => console.error(error));\n};\n\nconst hitsToSpanDetailData = async (hits, colorMap) => {\n  const data = {\n    gantt: [],\n    table: [],\n    ganttMaxX: 0\n  };\n  if (hits.length === 0) return data;\n  const minStartTime = nanoToMilliSec(hits[hits.length - 1].sort[0]);\n  let maxEndTime = 0;\n  hits.forEach(hit => {\n    const startTime = nanoToMilliSec(hit.sort[0]) - minStartTime;\n\n    const duration = _.round(nanoToMilliSec(hit._source.durationInNanos), 2);\n\n    const serviceName = _.get(hit, ['_source', 'serviceName']);\n\n    const name = _.get(hit, '_source.name');\n\n    const error = hit._source['status.code'] ? 'Error' : '';\n    const uniqueLabel = `${serviceName} <br>${name} ` + uuid();\n    maxEndTime = Math.max(maxEndTime, startTime + duration);\n    data.table.push({\n      service_name: serviceName,\n      span_id: hit._source.spanId,\n      latency: duration,\n      vs_benchmark: 0,\n      error,\n      start_time: hit._source.startTime,\n      end_time: hit._source.endTime\n    });\n    data.gantt.push({\n      x: [startTime],\n      y: [uniqueLabel],\n      marker: {\n        color: 'rgba(0, 0, 0, 0)'\n      },\n      width: 0.4,\n      type: 'bar',\n      orientation: 'h',\n      hoverinfo: 'none',\n      showlegend: false\n    }, {\n      x: [duration],\n      y: [uniqueLabel],\n      text: [error],\n      textfont: {\n        color: ['#c14125']\n      },\n      textposition: 'outside',\n      marker: {\n        color: colorMap[serviceName]\n      },\n      width: 0.4,\n      type: 'bar',\n      orientation: 'h',\n      hovertemplate: '%{x}<extra></extra>'\n    });\n  });\n  data.ganttMaxX = maxEndTime;\n  return data;\n};\n\nexport const handlePayloadRequest = (traceId, http, payloadData, setPayloadData) => {\n  handleDslRequest(http, null, getPayloadQuery(traceId)).then(response => setPayloadData(JSON.stringify(response.hits.hits, null, 2))).catch(error => console.error(error));\n};","/*\n *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *   Licensed under the Apache License, Version 2.0 (the \"License\").\n *   You may not use this file except in compliance with the License.\n *   A copy of the License is located at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n *   or in the \"license\" file accompanying this file. This file is distributed\n *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *   express or implied. See the License for the specific language governing\n *   permissions and limitations under the License.\n */\nexport const SQL_CLUSTER = 'opendistro_sql';\nexport const INDICES_ROUTE = '/api/trace_analytics/indices';\nexport const DSL_ROUTE = '/api/trace_analytics/query';\nexport const SQL_ROUTE = '/api/trace_analytics/sqlquery';\nexport const SQL_ES_ENDPOINT = '/_opendistro/_sql?format=json';"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjHA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9TA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5IA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3GA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1KA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACnSA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/IA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1IA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3LA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjSA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChQA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACnLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}